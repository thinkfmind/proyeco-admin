{"ast":null,"code":"var _jsxFileName = \"/Users/augusto/Desktop/proyeco-front/src/views/users/index.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useCallback } from \"react\";\nimport Navbar from \"../../@app/navbar\";\nimport { ChevronLeftIcon, TrashIcon } from \"@heroicons/react/outline\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Link, Redirect, useHistory } from \"react-router-dom\";\nimport TextInput from \"../../components/form/textInput\";\nimport PasswordInput from \"../../components/form/passwordInput\";\nimport ItemSelector from \"../../components/form/itemSelector\";\nimport toast, { Toaster } from \"react-hot-toast\";\nimport axios from \"axios\";\nimport Table from \"../../components/users/table\";\nimport { useDropzone } from \"react-dropzone\";\nimport { logout } from \"../../redux/ducks/user\";\nimport { CameraIcon } from \"@heroicons/react/outline\";\nimport Swal from \"sweetalert2\";\nimport Alert from \"../../components/alert\";\nimport { backendUrl, s3BucketUrl } from \"../../config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Users = () => {\n  _s();\n\n  const userSelector = useSelector(store => store.user);\n  const [data, setData] = useState([]);\n  const [nameError, setNameError] = useState(false);\n  const [usernameError, setUsernameError] = useState(false);\n  const [passwordError, setPasswordError] = useState(false);\n  const [hide, setHide] = useState(true);\n  const [role, setRole] = useState(\"\");\n  const [roleError, setRoleError] = useState(false);\n  const [name, setName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [username, setUsername] = useState(\"\");\n  const [editable, setEditable] = useState(false);\n  const [successAlert, setSuccessAlert] = useState(false);\n  const [img, setImg] = useState(\"\");\n  const [file, setFile] = useState([]);\n  const onDrop = useCallback(acceptedFiles => {\n    setFile([...file, ...acceptedFiles]);\n  }, [file]);\n  const {\n    getRootProps,\n    getInputProps\n  } = useDropzone({\n    onDrop,\n    multiple: false,\n    accept: \"image/jpeg, image/png\"\n  });\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const files = file.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: file.path\n  }, file.path, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 36\n  }, this));\n  const [userId, setUserId] = useState(\"\");\n\n  const handleEdit = (id, name, role, username, image) => {\n    setEditable(true);\n    setUserId(id);\n    setName(name);\n    setRole(role);\n    setUsername(username);\n    setImg(image);\n  };\n\n  const onChangeName = value => {\n    setName(value);\n    setNameError(false);\n  };\n\n  const onChangeUsername = value => {\n    setUsername(value);\n    setUsernameError(false);\n  };\n\n  const onChangeRole = value => {\n    setRole(value);\n  };\n\n  const onChangePassword = value => {\n    setPassword(value);\n    setPasswordError(false);\n  };\n\n  const onSetHide = value => {\n    setHide(value);\n  };\n\n  const successAlertHandler = () => {\n    setSuccessAlert(true);\n    setTimeout(() => {\n      setSuccessAlert(false);\n    }, 1500);\n  };\n\n  const alert = (id, tag) => {\n    Swal.fire({\n      title: \"¿Eliminar de forma permanente?\",\n      showCancelButton: true,\n      html: \"Se eliminaran todos los datos asociados\",\n      confirmButtonText: \"Eliminar\",\n      cancelButtonText: \"Cancelar\",\n      customClass: {\n        container: \"sw-container\",\n        title: \"sw-title text-lg font-objetive-bold\",\n        confirmButton: \"sw-confirm font-objetive-bold\",\n        cancelButton: \"sw-cancel font-objetive-bold\",\n        htmlContainer: \"sw-html font-objetive-medium\"\n      }\n    }).then(result => {\n      if (result.isConfirmed) {\n        deleteItem(id, tag);\n      }\n    });\n  };\n\n  const deleteItem = async id => {\n    const toastLoading = toast.loading(\"Eliminando...\");\n\n    try {\n      await axios({\n        method: \"DELETE\",\n        url: `${backendUrl}/user/${id}`,\n        headers: {\n          Authorization: `Bearer ${userSelector.user.jwtToken}`\n        }\n      });\n      toast.dismiss(toastLoading);\n      toast.success(\"Eliminado con éxito!\");\n      consult();\n    } catch {\n      toast.dismiss(toastLoading);\n      toast.error(\"Error al eliminar!\");\n    }\n  };\n\n  const onSubmit = async () => {\n    const toastLoading = toast.loading(\"Cargando...\");\n    let errName = false;\n    let errUser = false;\n    let errPass = false;\n\n    if (name.length < 1) {\n      setNameError(true);\n      errName = true;\n    }\n\n    if (username.length < 1) {\n      setUsernameError(true);\n      errUser = true;\n    }\n\n    if (password.length < 8 && !editable) {\n      setPasswordError(true);\n      errPass = true;\n    }\n\n    if (password.length > 0 && editable) {\n      if (password.length < 8) {\n        setPasswordError(true);\n        errPass = true;\n      }\n    }\n\n    if (editable) {\n      if (!errName && !errUser && !errPass) {\n        try {\n          const formData = new FormData();\n          formData.append(\"name\", name);\n          formData.append(\"username\", username);\n          formData.append(\"password\", password);\n          formData.append(\"role\", role);\n          formData.append(\"image\", file[0]);\n          await axios({\n            method: \"PUT\",\n            url: `${backendUrl}/user/${userId}`,\n            data: formData,\n            headers: {\n              Authorization: `Bearer ${userSelector.user.jwtToken}`,\n              \"Content-Type\": \"multipart/form-data boundary=\" + Math.random().toString().substr(2)\n            }\n          });\n          setName(\"\");\n          setPassword(\"\");\n          setUsername(\"\");\n          setUserId(\"\");\n          setRole(\"\");\n          setEditable(false);\n          toast.dismiss(toastLoading);\n          successAlertHandler();\n          await consult();\n        } catch {\n          toast.dismiss(toastLoading);\n          toast.error(\"Error al editar!\");\n        }\n      } else {\n        toast.dismiss(toastLoading);\n        toast.error(\"Verifique que los datos sean correctos!\");\n      }\n    } else {\n      if (!errName && !errUser && !errPass) {\n        try {\n          const formData = new FormData();\n          formData.append(\"name\", name);\n          formData.append(\"username\", username);\n          formData.append(\"password\", password);\n          formData.append(\"role\", role);\n          formData.append(\"image\", file[0]);\n          await axios({\n            method: \"POST\",\n            url: `${backendUrl}/user/register`,\n            data: formData,\n            headers: {\n              Authorization: `Bearer ${userSelector.user.jwtToken}`,\n              \"Content-Type\": \"multipart/form-data boundary=\" + Math.random().toString().substr(2)\n            }\n          });\n          setName(\"\");\n          setPassword(\"\");\n          setUsername(\"\");\n          toast.dismiss(toastLoading);\n          successAlertHandler();\n          await consult();\n        } catch {\n          toast.dismiss(toastLoading);\n          toast.error(\"Nombre de usuario duplicado!\");\n        }\n      } else {\n        toast.dismiss(toastLoading);\n        toast.error(\"Verifique que los datos sean correctos!\");\n      }\n    }\n  };\n\n  const deleteImg = () => {\n    setImg(\"\");\n\n    if (files.length > 0) {\n      setFile([]);\n    }\n  };\n\n  const consult = async () => {\n    const toastLoading = toast.loading(\"Cargando...\");\n\n    try {\n      const res = await axios.get(`${backendUrl}/user/`, {\n        headers: {\n          Authorization: `Bearer ${userSelector.user.jwtToken}`\n        }\n      });\n      setData(res.data);\n      toast.dismiss(toastLoading);\n    } catch (error) {\n      toast.dismiss(toastLoading);\n      toast.error(\"Error al conectarse al servidor!\");\n\n      if (error.response.status === 401) {\n        dispatch(logout(history));\n      }\n    }\n  };\n\n  useEffect(() => {\n    consult();\n  }, []);\n  const roleData = [{\n    id: \"Admin\",\n    name: \"Administrador\"\n  }, {\n    id: \"Empresa\",\n    name: \"Empresa de mantenimiento\"\n  }, {\n    id: \"Gerente\",\n    name: \"Gerente\"\n  }];\n\n  if (userSelector.user.role !== \"Admin\") {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/home\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 12\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [successAlert ? /*#__PURE__*/_jsxDEV(Alert, {\n        text: \"Usuario guardado\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 25\n      }, this) : null, /*#__PURE__*/_jsxDEV(Toaster, {\n        position: \"top-right\",\n        reverseOrder: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Navbar, {\n        title: \"Administrar Usuarios\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative justify-center px-20 vp-desktop\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex mt-14\",\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: \"/home\",\n            children: /*#__PURE__*/_jsxDEV(ChevronLeftIcon, {\n              className: \"w-5 h-5 mr-2 text-gray-700\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            className: \"font-objetive-medium\",\n            to: \"/home\",\n            children: \"Volver\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full px-10 pt-10 pb-24 mt-6 bg-gray-100 rounded-3xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"mb-6 text-lg font-objetive-bold\",\n            children: editable ? \"Editar usuario\" : \"Cargar nuevo usuario\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n            placeholder: \"Nombre\",\n            eventHandler: onChangeName,\n            error: nameError,\n            value: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex mt-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full pr-4\",\n              children: /*#__PURE__*/_jsxDEV(TextInput, {\n                placeholder: \"Usuario\",\n                eventHandler: onChangeUsername,\n                error: usernameError,\n                value: username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full pl-4\",\n              children: [/*#__PURE__*/_jsxDEV(PasswordInput, {\n                placeholder: \"Contrase\\xF1a\",\n                eventHandler: onChangePassword,\n                error: passwordError,\n                hide: hide,\n                setHide: onSetHide,\n                value: password\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 308,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pl-8 mt-4 text-sm text-left font-objetive-regular\",\n                children: \"Debe tener al menos 8 caracteres\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full pr-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-objetive-medium\",\n                children: \"Imagen de empresa\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 font-objetive-regular\",\n                children: \"Formatos aceptados JPEG, JPG, PNG en 72 dpi.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", { ...getRootProps({\n                  className: \"dropzone\"\n                }),\n                children: [/*#__PURE__*/_jsxDEV(\"input\", { ...getInputProps()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center mr-10 cursor-pointer\",\n                  children: [img ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mr-6 bg-gray-100 rounded-xl\",\n                    children: /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: img,\n                      alt: \"Imagen\",\n                      className: \"object-contain w-20 h-20 rounded-xl\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 333,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 332,\n                    columnNumber: 23\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center justify-center w-20 h-20 mr-6 align-middle bg-gray-300 rounded-xl\",\n                    children: /*#__PURE__*/_jsxDEV(CameraIcon, {\n                      className: \"z-10 w-10 h-10 text-gray-700\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 341,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 340,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                      className: \"underline font-objetive-bold text-app-violet-300\",\n                      children: \"Seleccionar im\\xE1gen\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 346,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                      className: \"text-sm text-gray-700 font-objetive-regular w-52\",\n                      children: files.length > 0 ? files : img ? img.replace(`${s3BucketUrl}/empresas/`, \"\") : \"No se selecciono imagen\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 349,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 345,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 17\n              }, this), files.length > 0 || img ? /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: deleteImg,\n                className: \"flex items-center justify-center w-20 h-5 mt-2 bg-red-600 cursor-pointer rounded-xl\",\n                children: /*#__PURE__*/_jsxDEV(TrashIcon, {\n                  className: \"w-4 h-4 text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 364,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 19\n              }, this) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full pl-10 mt-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pl-4 mb-4 font-objetive-medium\",\n                children: \"Tipo de usuario\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ItemSelector, {\n                eventHandler: onChangeRole,\n                data: roleData,\n                value: role,\n                text: \"Tipo\",\n                error: roleError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: onSubmit,\n            className: \"absolute inline-flex items-center px-4 pt-4 pb-3 text-base text-white border border-transparent rounded-full shadow-sm bottom--20 right-32 font-objetive-medium bg-app-purple-btn hover:bg-red-500 focus:outline-none \",\n            children: editable ? \"Editar usuario\" : \"Guardar usuario\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        data: data,\n        handleEdit: handleEdit,\n        alert: alert\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n};\n\n_s(Users, \"opzcNntGitI+HllUZn1hscnSOr0=\", false, function () {\n  return [useSelector, useDropzone, useDispatch, useHistory];\n});\n\n_c = Users;\nexport default Users;\n\nvar _c;\n\n$RefreshReg$(_c, \"Users\");","map":{"version":3,"sources":["/Users/augusto/Desktop/proyeco-front/src/views/users/index.js"],"names":["useEffect","useState","useCallback","Navbar","ChevronLeftIcon","TrashIcon","useSelector","useDispatch","Link","Redirect","useHistory","TextInput","PasswordInput","ItemSelector","toast","Toaster","axios","Table","useDropzone","logout","CameraIcon","Swal","Alert","backendUrl","s3BucketUrl","Users","userSelector","store","user","data","setData","nameError","setNameError","usernameError","setUsernameError","passwordError","setPasswordError","hide","setHide","role","setRole","roleError","setRoleError","name","setName","password","setPassword","username","setUsername","editable","setEditable","successAlert","setSuccessAlert","img","setImg","file","setFile","onDrop","acceptedFiles","getRootProps","getInputProps","multiple","accept","dispatch","history","files","map","path","userId","setUserId","handleEdit","id","image","onChangeName","value","onChangeUsername","onChangeRole","onChangePassword","onSetHide","successAlertHandler","setTimeout","alert","tag","fire","title","showCancelButton","html","confirmButtonText","cancelButtonText","customClass","container","confirmButton","cancelButton","htmlContainer","then","result","isConfirmed","deleteItem","toastLoading","loading","method","url","headers","Authorization","jwtToken","dismiss","success","consult","error","onSubmit","errName","errUser","errPass","length","formData","FormData","append","Math","random","toString","substr","deleteImg","res","get","response","status","roleData","className","replace"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,WAA9B,QAAiD,OAAjD;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,eAAT,EAA0BC,SAA1B,QAA2C,0BAA3C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,IAAT,EAAeC,QAAf,EAAyBC,UAAzB,QAA2C,kBAA3C;AACA,OAAOC,SAAP,MAAsB,iCAAtB;AACA,OAAOC,aAAP,MAA0B,qCAA1B;AACA,OAAOC,YAAP,MAAyB,oCAAzB;AACA,OAAOC,KAAP,IAAgBC,OAAhB,QAA+B,iBAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,8BAAlB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,MAAT,QAAuB,wBAAvB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,KAAP,MAAkB,wBAAlB;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,cAAxC;;;;AAEA,MAAMC,KAAK,GAAG,MAAM;AAAA;;AAClB,QAAMC,YAAY,GAAGpB,WAAW,CAAEqB,KAAD,IAAWA,KAAK,CAACC,IAAlB,CAAhC;AACA,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkB7B,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAAC8B,SAAD,EAAYC,YAAZ,IAA4B/B,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACgC,aAAD,EAAgBC,gBAAhB,IAAoCjC,QAAQ,CAAC,KAAD,CAAlD;AACA,QAAM,CAACkC,aAAD,EAAgBC,gBAAhB,IAAoCnC,QAAQ,CAAC,KAAD,CAAlD;AACA,QAAM,CAACoC,IAAD,EAAOC,OAAP,IAAkBrC,QAAQ,CAAC,IAAD,CAAhC;AACA,QAAM,CAACsC,IAAD,EAAOC,OAAP,IAAkBvC,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACwC,SAAD,EAAYC,YAAZ,IAA4BzC,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAAC0C,IAAD,EAAOC,OAAP,IAAkB3C,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAAC4C,QAAD,EAAWC,WAAX,IAA0B7C,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC8C,QAAD,EAAWC,WAAX,IAA0B/C,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACgD,QAAD,EAAWC,WAAX,IAA0BjD,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,CAACkD,YAAD,EAAeC,eAAf,IAAkCnD,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAACoD,GAAD,EAAMC,MAAN,IAAgBrD,QAAQ,CAAC,EAAD,CAA9B;AACA,QAAM,CAACsD,IAAD,EAAOC,OAAP,IAAkBvD,QAAQ,CAAC,EAAD,CAAhC;AAEA,QAAMwD,MAAM,GAAGvD,WAAW,CACvBwD,aAAD,IAAmB;AACjBF,IAAAA,OAAO,CAAC,CAAC,GAAGD,IAAJ,EAAU,GAAGG,aAAb,CAAD,CAAP;AACD,GAHuB,EAIxB,CAACH,IAAD,CAJwB,CAA1B;AAOA,QAAM;AAAEI,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAAkC1C,WAAW,CAAC;AAClDuC,IAAAA,MADkD;AAElDI,IAAAA,QAAQ,EAAE,KAFwC;AAGlDC,IAAAA,MAAM,EAAE;AAH0C,GAAD,CAAnD;AAMA,QAAMC,QAAQ,GAAGxD,WAAW,EAA5B;AACA,QAAMyD,OAAO,GAAGtD,UAAU,EAA1B;AAEA,QAAMuD,KAAK,GAAGV,IAAI,CAACW,GAAL,CAAUX,IAAD,iBAAU;AAAA,cAAsBA,IAAI,CAACY;AAA3B,KAAUZ,IAAI,CAACY,IAAf;AAAA;AAAA;AAAA;AAAA,UAAnB,CAAd;AAEA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBpE,QAAQ,CAAC,EAAD,CAApC;;AACA,QAAMqE,UAAU,GAAG,CAACC,EAAD,EAAK5B,IAAL,EAAWJ,IAAX,EAAiBQ,QAAjB,EAA2ByB,KAA3B,KAAqC;AACtDtB,IAAAA,WAAW,CAAC,IAAD,CAAX;AACAmB,IAAAA,SAAS,CAACE,EAAD,CAAT;AACA3B,IAAAA,OAAO,CAACD,IAAD,CAAP;AACAH,IAAAA,OAAO,CAACD,IAAD,CAAP;AACAS,IAAAA,WAAW,CAACD,QAAD,CAAX;AACAO,IAAAA,MAAM,CAACkB,KAAD,CAAN;AACD,GAPD;;AASA,QAAMC,YAAY,GAAIC,KAAD,IAAW;AAC9B9B,IAAAA,OAAO,CAAC8B,KAAD,CAAP;AACA1C,IAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,GAHD;;AAKA,QAAM2C,gBAAgB,GAAID,KAAD,IAAW;AAClC1B,IAAAA,WAAW,CAAC0B,KAAD,CAAX;AACAxC,IAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACD,GAHD;;AAKA,QAAM0C,YAAY,GAAIF,KAAD,IAAW;AAC9BlC,IAAAA,OAAO,CAACkC,KAAD,CAAP;AACD,GAFD;;AAIA,QAAMG,gBAAgB,GAAIH,KAAD,IAAW;AAClC5B,IAAAA,WAAW,CAAC4B,KAAD,CAAX;AACAtC,IAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACD,GAHD;;AAKA,QAAM0C,SAAS,GAAIJ,KAAD,IAAW;AAC3BpC,IAAAA,OAAO,CAACoC,KAAD,CAAP;AACD,GAFD;;AAIA,QAAMK,mBAAmB,GAAG,MAAM;AAChC3B,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA4B,IAAAA,UAAU,CAAC,MAAM;AACf5B,MAAAA,eAAe,CAAC,KAAD,CAAf;AACD,KAFS,EAEP,IAFO,CAAV;AAGD,GALD;;AAOA,QAAM6B,KAAK,GAAG,CAACV,EAAD,EAAKW,GAAL,KAAa;AACzB7D,IAAAA,IAAI,CAAC8D,IAAL,CAAU;AACRC,MAAAA,KAAK,EAAE,gCADC;AAERC,MAAAA,gBAAgB,EAAE,IAFV;AAGRC,MAAAA,IAAI,EAAE,yCAHE;AAIRC,MAAAA,iBAAiB,EAAE,UAJX;AAKRC,MAAAA,gBAAgB,EAAE,UALV;AAMRC,MAAAA,WAAW,EAAE;AACXC,QAAAA,SAAS,EAAE,cADA;AAEXN,QAAAA,KAAK,EAAE,qCAFI;AAGXO,QAAAA,aAAa,EAAE,+BAHJ;AAIXC,QAAAA,YAAY,EAAE,8BAJH;AAKXC,QAAAA,aAAa,EAAE;AALJ;AANL,KAAV,EAaGC,IAbH,CAaSC,MAAD,IAAY;AAClB,UAAIA,MAAM,CAACC,WAAX,EAAwB;AACtBC,QAAAA,UAAU,CAAC1B,EAAD,EAAKW,GAAL,CAAV;AACD;AACF,KAjBD;AAkBD,GAnBD;;AAqBA,QAAMe,UAAU,GAAG,MAAO1B,EAAP,IAAc;AAC/B,UAAM2B,YAAY,GAAGpF,KAAK,CAACqF,OAAN,CAAc,eAAd,CAArB;;AACA,QAAI;AACF,YAAMnF,KAAK,CAAC;AACVoF,QAAAA,MAAM,EAAE,QADE;AAEVC,QAAAA,GAAG,EAAG,GAAE9E,UAAW,SAAQgD,EAAG,EAFpB;AAGV+B,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAG,UAAS7E,YAAY,CAACE,IAAb,CAAkB4E,QAAS;AAD7C;AAHC,OAAD,CAAX;AAOA1F,MAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,MAAAA,KAAK,CAAC4F,OAAN,CAAc,sBAAd;AACAC,MAAAA,OAAO;AACR,KAXD,CAWE,MAAM;AACN7F,MAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,MAAAA,KAAK,CAAC8F,KAAN,CAAY,oBAAZ;AACD;AACF,GAjBD;;AAmBA,QAAMC,QAAQ,GAAG,YAAY;AAC3B,UAAMX,YAAY,GAAGpF,KAAK,CAACqF,OAAN,CAAc,aAAd,CAArB;AACA,QAAIW,OAAO,GAAG,KAAd;AACA,QAAIC,OAAO,GAAG,KAAd;AACA,QAAIC,OAAO,GAAG,KAAd;;AAEA,QAAIrE,IAAI,CAACsE,MAAL,GAAc,CAAlB,EAAqB;AACnBjF,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACA8E,MAAAA,OAAO,GAAG,IAAV;AACD;;AACD,QAAI/D,QAAQ,CAACkE,MAAT,GAAkB,CAAtB,EAAyB;AACvB/E,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACA6E,MAAAA,OAAO,GAAG,IAAV;AACD;;AACD,QAAIlE,QAAQ,CAACoE,MAAT,GAAkB,CAAlB,IAAuB,CAAChE,QAA5B,EAAsC;AACpCb,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACA4E,MAAAA,OAAO,GAAG,IAAV;AACD;;AAED,QAAInE,QAAQ,CAACoE,MAAT,GAAkB,CAAlB,IAAuBhE,QAA3B,EAAqC;AACnC,UAAIJ,QAAQ,CAACoE,MAAT,GAAkB,CAAtB,EAAyB;AACvB7E,QAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACA4E,QAAAA,OAAO,GAAG,IAAV;AACD;AACF;;AAED,QAAI/D,QAAJ,EAAc;AACZ,UAAI,CAAC6D,OAAD,IAAY,CAACC,OAAb,IAAwB,CAACC,OAA7B,EAAsC;AACpC,YAAI;AACF,gBAAME,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,UAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBzE,IAAxB;AACAuE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,UAAhB,EAA4BrE,QAA5B;AACAmE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,UAAhB,EAA4BvE,QAA5B;AACAqE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB7E,IAAxB;AACA2E,UAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB7D,IAAI,CAAC,CAAD,CAA7B;AACA,gBAAMvC,KAAK,CAAC;AACVoF,YAAAA,MAAM,EAAE,KADE;AAEVC,YAAAA,GAAG,EAAG,GAAE9E,UAAW,SAAQ6C,MAAO,EAFxB;AAGVvC,YAAAA,IAAI,EAAEqF,QAHI;AAIVZ,YAAAA,OAAO,EAAE;AACPC,cAAAA,aAAa,EAAG,UAAS7E,YAAY,CAACE,IAAb,CAAkB4E,QAAS,EAD7C;AAEP,8BACE,kCACAa,IAAI,CAACC,MAAL,GAAcC,QAAd,GAAyBC,MAAzB,CAAgC,CAAhC;AAJK;AAJC,WAAD,CAAX;AAWA5E,UAAAA,OAAO,CAAC,EAAD,CAAP;AACAE,UAAAA,WAAW,CAAC,EAAD,CAAX;AACAE,UAAAA,WAAW,CAAC,EAAD,CAAX;AACAqB,UAAAA,SAAS,CAAC,EAAD,CAAT;AACA7B,UAAAA,OAAO,CAAC,EAAD,CAAP;AACAU,UAAAA,WAAW,CAAC,KAAD,CAAX;AACApC,UAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACAnB,UAAAA,mBAAmB;AACnB,gBAAM4B,OAAO,EAAb;AACD,SA3BD,CA2BE,MAAM;AACN7F,UAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,UAAAA,KAAK,CAAC8F,KAAN,CAAY,kBAAZ;AACD;AACF,OAhCD,MAgCO;AACL9F,QAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,QAAAA,KAAK,CAAC8F,KAAN,CAAY,yCAAZ;AACD;AACF,KArCD,MAqCO;AACL,UAAI,CAACE,OAAD,IAAY,CAACC,OAAb,IAAwB,CAACC,OAA7B,EAAsC;AACpC,YAAI;AACF,gBAAME,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,UAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBzE,IAAxB;AACAuE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,UAAhB,EAA4BrE,QAA5B;AACAmE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,UAAhB,EAA4BvE,QAA5B;AACAqE,UAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB7E,IAAxB;AACA2E,UAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB7D,IAAI,CAAC,CAAD,CAA7B;AACA,gBAAMvC,KAAK,CAAC;AACVoF,YAAAA,MAAM,EAAE,MADE;AAEVC,YAAAA,GAAG,EAAG,GAAE9E,UAAW,gBAFT;AAGVM,YAAAA,IAAI,EAAEqF,QAHI;AAIVZ,YAAAA,OAAO,EAAE;AACPC,cAAAA,aAAa,EAAG,UAAS7E,YAAY,CAACE,IAAb,CAAkB4E,QAAS,EAD7C;AAEP,8BACE,kCACAa,IAAI,CAACC,MAAL,GAAcC,QAAd,GAAyBC,MAAzB,CAAgC,CAAhC;AAJK;AAJC,WAAD,CAAX;AAWA5E,UAAAA,OAAO,CAAC,EAAD,CAAP;AACAE,UAAAA,WAAW,CAAC,EAAD,CAAX;AACAE,UAAAA,WAAW,CAAC,EAAD,CAAX;AACAlC,UAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACAnB,UAAAA,mBAAmB;AACnB,gBAAM4B,OAAO,EAAb;AACD,SAxBD,CAwBE,MAAM;AACN7F,UAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,UAAAA,KAAK,CAAC8F,KAAN,CAAY,8BAAZ;AACD;AACF,OA7BD,MA6BO;AACL9F,QAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,QAAAA,KAAK,CAAC8F,KAAN,CAAY,yCAAZ;AACD;AACF;AACF,GAlGD;;AAoGA,QAAMa,SAAS,GAAG,MAAM;AACtBnE,IAAAA,MAAM,CAAC,EAAD,CAAN;;AACA,QAAIW,KAAK,CAACgD,MAAN,GAAe,CAAnB,EAAsB;AACpBzD,MAAAA,OAAO,CAAC,EAAD,CAAP;AACD;AACF,GALD;;AAOA,QAAMmD,OAAO,GAAG,YAAY;AAC1B,UAAMT,YAAY,GAAGpF,KAAK,CAACqF,OAAN,CAAc,aAAd,CAArB;;AACA,QAAI;AACF,YAAMuB,GAAG,GAAG,MAAM1G,KAAK,CAAC2G,GAAN,CAAW,GAAEpG,UAAW,QAAxB,EAAiC;AACjD+E,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAG,UAAS7E,YAAY,CAACE,IAAb,CAAkB4E,QAAS;AAD7C;AADwC,OAAjC,CAAlB;AAKA1E,MAAAA,OAAO,CAAC4F,GAAG,CAAC7F,IAAL,CAAP;AACAf,MAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACD,KARD,CAQE,OAAOU,KAAP,EAAc;AACd9F,MAAAA,KAAK,CAAC2F,OAAN,CAAcP,YAAd;AACApF,MAAAA,KAAK,CAAC8F,KAAN,CAAY,kCAAZ;;AACA,UAAIA,KAAK,CAACgB,QAAN,CAAeC,MAAf,KAA0B,GAA9B,EAAmC;AACjC9D,QAAAA,QAAQ,CAAC5C,MAAM,CAAC6C,OAAD,CAAP,CAAR;AACD;AACF;AACF,GAjBD;;AAmBAhE,EAAAA,SAAS,CAAC,MAAM;AACd2G,IAAAA,OAAO;AACR,GAFQ,EAEN,EAFM,CAAT;AAIA,QAAMmB,QAAQ,GAAG,CACf;AAAEvD,IAAAA,EAAE,EAAE,OAAN;AAAe5B,IAAAA,IAAI,EAAE;AAArB,GADe,EAEf;AAAE4B,IAAAA,EAAE,EAAE,SAAN;AAAiB5B,IAAAA,IAAI,EAAE;AAAvB,GAFe,EAGf;AAAE4B,IAAAA,EAAE,EAAE,SAAN;AAAiB5B,IAAAA,IAAI,EAAE;AAAvB,GAHe,CAAjB;;AAMA,MAAIjB,YAAY,CAACE,IAAb,CAAkBW,IAAlB,KAA2B,OAA/B,EAAwC;AACtC,wBAAO,QAAC,QAAD;AAAU,MAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,YAAP;AACD,GAFD,MAEO;AACL,wBACE;AAAA,iBACGY,YAAY,gBAAG,QAAC,KAAD;AAAO,QAAA,IAAI,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,cAAH,GAAuC,IADtD,eAEE,QAAC,OAAD;AAAS,QAAA,QAAQ,EAAC,WAAlB;AAA8B,QAAA,YAAY,EAAE;AAA5C;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE,QAAC,MAAD;AAAQ,QAAA,KAAK,EAAC;AAAd;AAAA;AAAA;AAAA;AAAA,cAHF,eAIE;AAAK,QAAA,SAAS,EAAC,0CAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,kCACE,QAAC,IAAD;AAAM,YAAA,EAAE,EAAC,OAAT;AAAA,mCACE,QAAC,eAAD;AAAiB,cAAA,SAAS,EAAC;AAA3B;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,eAIE,QAAC,IAAD;AAAM,YAAA,SAAS,EAAC,sBAAhB;AAAuC,YAAA,EAAE,EAAC,OAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eASE;AAAK,UAAA,SAAS,EAAC,uDAAf;AAAA,kCACE;AAAI,YAAA,SAAS,EAAC,iCAAd;AAAA,sBACGF,QAAQ,GAAG,gBAAH,GAAsB;AADjC;AAAA;AAAA;AAAA;AAAA,kBADF,eAIE,QAAC,SAAD;AACE,YAAA,WAAW,EAAC,QADd;AAEE,YAAA,YAAY,EAAEwB,YAFhB;AAGE,YAAA,KAAK,EAAE1C,SAHT;AAIE,YAAA,KAAK,EAAEY;AAJT;AAAA;AAAA;AAAA;AAAA,kBAJF,eAWE;AAAK,YAAA,SAAS,EAAC,WAAf;AAAA,oCACE;AAAK,cAAA,SAAS,EAAC,aAAf;AAAA,qCACE,QAAC,SAAD;AACE,gBAAA,WAAW,EAAC,SADd;AAEE,gBAAA,YAAY,EAAEgC,gBAFhB;AAGE,gBAAA,KAAK,EAAE1C,aAHT;AAIE,gBAAA,KAAK,EAAEc;AAJT;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADF,eASE;AAAK,cAAA,SAAS,EAAC,aAAf;AAAA,sCACE,QAAC,aAAD;AACE,gBAAA,WAAW,EAAC,eADd;AAEE,gBAAA,YAAY,EAAE8B,gBAFhB;AAGE,gBAAA,KAAK,EAAE1C,aAHT;AAIE,gBAAA,IAAI,EAAEE,IAJR;AAKE,gBAAA,OAAO,EAAEyC,SALX;AAME,gBAAA,KAAK,EAAEjC;AANT;AAAA;AAAA;AAAA;AAAA,sBADF,eASE;AAAK,gBAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBATF;AAAA;AAAA;AAAA;AAAA;AAAA,oBATF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAXF,eAmCE;AAAK,YAAA,SAAS,EAAC,MAAf;AAAA,oCACE;AAAK,cAAA,SAAS,EAAC,aAAf;AAAA,sCACE;AAAK,gBAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAK,gBAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF,eAKE,oBAASc,YAAY,CAAC;AAAEoE,kBAAAA,SAAS,EAAE;AAAb,iBAAD,CAArB;AAAA,wCACE,sBAAWnE,aAAa;AAAxB;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAK,kBAAA,SAAS,EAAC,wCAAf;AAAA,6BACGP,GAAG,gBACF;AAAK,oBAAA,SAAS,EAAC,6BAAf;AAAA,2CACE;AACE,sBAAA,GAAG,EAAEA,GADP;AAEE,sBAAA,GAAG,EAAC,QAFN;AAGE,sBAAA,SAAS,EAAC;AAHZ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BADE,gBASF;AAAK,oBAAA,SAAS,EAAC,qFAAf;AAAA,2CACE,QAAC,UAAD;AAAY,sBAAA,SAAS,EAAC;AAAtB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BAVJ,eAeE;AAAA,4CACE;AAAI,sBAAA,SAAS,EAAC,kDAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF,eAIE;AAAI,sBAAA,SAAS,EAAC,kDAAd;AAAA,gCACGY,KAAK,CAACgD,MAAN,GAAe,CAAf,GACGhD,KADH,GAEGZ,GAAG,GACHA,GAAG,CAAC2E,OAAJ,CAAa,GAAExG,WAAY,YAA3B,EAAwC,EAAxC,CADG,GAEH;AALN;AAAA;AAAA;AAAA;AAAA,4BAJF;AAAA;AAAA;AAAA;AAAA;AAAA,0BAfF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBALF,EAoCGyC,KAAK,CAACgD,MAAN,GAAe,CAAf,IAAoB5D,GAApB,gBACC;AACE,gBAAA,OAAO,EAAEoE,SADX;AAEE,gBAAA,SAAS,EAAC,qFAFZ;AAAA,uCAIE,QAAC,SAAD;AAAW,kBAAA,SAAS,EAAC;AAArB;AAAA;AAAA;AAAA;AAAA;AAJF;AAAA;AAAA;AAAA;AAAA,sBADD,GAOG,IA3CN;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eA+CE;AAAK,cAAA,SAAS,EAAC,mBAAf;AAAA,sCACE;AAAK,gBAAA,SAAS,EAAC,gCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAIE,QAAC,YAAD;AACE,gBAAA,YAAY,EAAE7C,YADhB;AAEE,gBAAA,IAAI,EAAEkD,QAFR;AAGE,gBAAA,KAAK,EAAEvF,IAHT;AAIE,gBAAA,IAAI,EAAC,MAJP;AAKE,gBAAA,KAAK,EAAEE;AALT;AAAA;AAAA;AAAA;AAAA,sBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,oBA/CF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAnCF,eAgGE;AACE,YAAA,IAAI,EAAC,QADP;AAEE,YAAA,OAAO,EAAEoE,QAFX;AAGE,YAAA,SAAS,EAAC,wNAHZ;AAAA,sBAKG5D,QAAQ,GAAG,gBAAH,GAAsB;AALjC;AAAA;AAAA;AAAA;AAAA,kBAhGF;AAAA;AAAA;AAAA;AAAA;AAAA,gBATF;AAAA;AAAA;AAAA;AAAA;AAAA,cAJF,eAsHE,QAAC,KAAD;AAAO,QAAA,IAAI,EAAEpB,IAAb;AAAmB,QAAA,UAAU,EAAEyC,UAA/B;AAA2C,QAAA,KAAK,EAAEW;AAAlD;AAAA;AAAA;AAAA;AAAA,cAtHF;AAAA,oBADF;AA0HD;AACF,CAzXD;;GAAMxD,K;UACiBnB,W,EAuBmBY,W,EAMvBX,W,EACDG,U;;;KA/BZe,K;AA2XN,eAAeA,KAAf","sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\nimport Navbar from \"../../@app/navbar\";\nimport { ChevronLeftIcon, TrashIcon } from \"@heroicons/react/outline\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Link, Redirect, useHistory } from \"react-router-dom\";\nimport TextInput from \"../../components/form/textInput\";\nimport PasswordInput from \"../../components/form/passwordInput\";\nimport ItemSelector from \"../../components/form/itemSelector\";\nimport toast, { Toaster } from \"react-hot-toast\";\nimport axios from \"axios\";\nimport Table from \"../../components/users/table\";\nimport { useDropzone } from \"react-dropzone\";\nimport { logout } from \"../../redux/ducks/user\";\nimport { CameraIcon } from \"@heroicons/react/outline\";\nimport Swal from \"sweetalert2\";\nimport Alert from \"../../components/alert\";\nimport { backendUrl, s3BucketUrl } from \"../../config\";\n\nconst Users = () => {\n  const userSelector = useSelector((store) => store.user);\n  const [data, setData] = useState([]);\n  const [nameError, setNameError] = useState(false);\n  const [usernameError, setUsernameError] = useState(false);\n  const [passwordError, setPasswordError] = useState(false);\n  const [hide, setHide] = useState(true);\n  const [role, setRole] = useState(\"\");\n  const [roleError, setRoleError] = useState(false);\n  const [name, setName] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [username, setUsername] = useState(\"\");\n  const [editable, setEditable] = useState(false);\n  const [successAlert, setSuccessAlert] = useState(false);\n  const [img, setImg] = useState(\"\");\n  const [file, setFile] = useState([]);\n\n  const onDrop = useCallback(\n    (acceptedFiles) => {\n      setFile([...file, ...acceptedFiles]);\n    },\n    [file]\n  );\n\n  const { getRootProps, getInputProps } = useDropzone({\n    onDrop,\n    multiple: false,\n    accept: \"image/jpeg, image/png\",\n  });\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const files = file.map((file) => <div key={file.path}>{file.path}</div>);\n\n  const [userId, setUserId] = useState(\"\");\n  const handleEdit = (id, name, role, username, image) => {\n    setEditable(true);\n    setUserId(id);\n    setName(name);\n    setRole(role);\n    setUsername(username);\n    setImg(image);\n  };\n\n  const onChangeName = (value) => {\n    setName(value);\n    setNameError(false);\n  };\n\n  const onChangeUsername = (value) => {\n    setUsername(value);\n    setUsernameError(false);\n  };\n\n  const onChangeRole = (value) => {\n    setRole(value);\n  };\n\n  const onChangePassword = (value) => {\n    setPassword(value);\n    setPasswordError(false);\n  };\n\n  const onSetHide = (value) => {\n    setHide(value);\n  };\n\n  const successAlertHandler = () => {\n    setSuccessAlert(true);\n    setTimeout(() => {\n      setSuccessAlert(false);\n    }, 1500);\n  };\n\n  const alert = (id, tag) => {\n    Swal.fire({\n      title: \"¿Eliminar de forma permanente?\",\n      showCancelButton: true,\n      html: \"Se eliminaran todos los datos asociados\",\n      confirmButtonText: \"Eliminar\",\n      cancelButtonText: \"Cancelar\",\n      customClass: {\n        container: \"sw-container\",\n        title: \"sw-title text-lg font-objetive-bold\",\n        confirmButton: \"sw-confirm font-objetive-bold\",\n        cancelButton: \"sw-cancel font-objetive-bold\",\n        htmlContainer: \"sw-html font-objetive-medium\",\n      },\n    }).then((result) => {\n      if (result.isConfirmed) {\n        deleteItem(id, tag);\n      }\n    });\n  };\n\n  const deleteItem = async (id) => {\n    const toastLoading = toast.loading(\"Eliminando...\");\n    try {\n      await axios({\n        method: \"DELETE\",\n        url: `${backendUrl}/user/${id}`,\n        headers: {\n          Authorization: `Bearer ${userSelector.user.jwtToken}`,\n        },\n      });\n      toast.dismiss(toastLoading);\n      toast.success(\"Eliminado con éxito!\");\n      consult();\n    } catch {\n      toast.dismiss(toastLoading);\n      toast.error(\"Error al eliminar!\");\n    }\n  };\n\n  const onSubmit = async () => {\n    const toastLoading = toast.loading(\"Cargando...\");\n    let errName = false;\n    let errUser = false;\n    let errPass = false;\n\n    if (name.length < 1) {\n      setNameError(true);\n      errName = true;\n    }\n    if (username.length < 1) {\n      setUsernameError(true);\n      errUser = true;\n    }\n    if (password.length < 8 && !editable) {\n      setPasswordError(true);\n      errPass = true;\n    }\n\n    if (password.length > 0 && editable) {\n      if (password.length < 8) {\n        setPasswordError(true);\n        errPass = true;\n      }\n    }\n\n    if (editable) {\n      if (!errName && !errUser && !errPass) {\n        try {\n          const formData = new FormData();\n          formData.append(\"name\", name);\n          formData.append(\"username\", username);\n          formData.append(\"password\", password);\n          formData.append(\"role\", role);\n          formData.append(\"image\", file[0]);\n          await axios({\n            method: \"PUT\",\n            url: `${backendUrl}/user/${userId}`,\n            data: formData,\n            headers: {\n              Authorization: `Bearer ${userSelector.user.jwtToken}`,\n              \"Content-Type\":\n                \"multipart/form-data boundary=\" +\n                Math.random().toString().substr(2),\n            },\n          });\n          setName(\"\");\n          setPassword(\"\");\n          setUsername(\"\");\n          setUserId(\"\");\n          setRole(\"\");\n          setEditable(false);\n          toast.dismiss(toastLoading);\n          successAlertHandler();\n          await consult();\n        } catch {\n          toast.dismiss(toastLoading);\n          toast.error(\"Error al editar!\");\n        }\n      } else {\n        toast.dismiss(toastLoading);\n        toast.error(\"Verifique que los datos sean correctos!\");\n      }\n    } else {\n      if (!errName && !errUser && !errPass) {\n        try {\n          const formData = new FormData();\n          formData.append(\"name\", name);\n          formData.append(\"username\", username);\n          formData.append(\"password\", password);\n          formData.append(\"role\", role);\n          formData.append(\"image\", file[0]);\n          await axios({\n            method: \"POST\",\n            url: `${backendUrl}/user/register`,\n            data: formData,\n            headers: {\n              Authorization: `Bearer ${userSelector.user.jwtToken}`,\n              \"Content-Type\":\n                \"multipart/form-data boundary=\" +\n                Math.random().toString().substr(2),\n            },\n          });\n          setName(\"\");\n          setPassword(\"\");\n          setUsername(\"\");\n          toast.dismiss(toastLoading);\n          successAlertHandler();\n          await consult();\n        } catch {\n          toast.dismiss(toastLoading);\n          toast.error(\"Nombre de usuario duplicado!\");\n        }\n      } else {\n        toast.dismiss(toastLoading);\n        toast.error(\"Verifique que los datos sean correctos!\");\n      }\n    }\n  };\n\n  const deleteImg = () => {\n    setImg(\"\");\n    if (files.length > 0) {\n      setFile([]);\n    }\n  };\n\n  const consult = async () => {\n    const toastLoading = toast.loading(\"Cargando...\");\n    try {\n      const res = await axios.get(`${backendUrl}/user/`, {\n        headers: {\n          Authorization: `Bearer ${userSelector.user.jwtToken}`,\n        },\n      });\n      setData(res.data);\n      toast.dismiss(toastLoading);\n    } catch (error) {\n      toast.dismiss(toastLoading);\n      toast.error(\"Error al conectarse al servidor!\");\n      if (error.response.status === 401) {\n        dispatch(logout(history));\n      }\n    }\n  };\n\n  useEffect(() => {\n    consult();\n  }, []);\n\n  const roleData = [\n    { id: \"Admin\", name: \"Administrador\" },\n    { id: \"Empresa\", name: \"Empresa de mantenimiento\" },\n    { id: \"Gerente\", name: \"Gerente\" },\n  ];\n\n  if (userSelector.user.role !== \"Admin\") {\n    return <Redirect to=\"/home\" />;\n  } else {\n    return (\n      <>\n        {successAlert ? <Alert text=\"Usuario guardado\" /> : null}\n        <Toaster position=\"top-right\" reverseOrder={false} />\n        <Navbar title=\"Administrar Usuarios\" />\n        <div className=\"relative justify-center px-20 vp-desktop\">\n          <div className=\"flex mt-14\">\n            <Link to=\"/home\">\n              <ChevronLeftIcon className=\"w-5 h-5 mr-2 text-gray-700\" />\n            </Link>\n            <Link className=\"font-objetive-medium\" to=\"/home\">\n              Volver\n            </Link>\n          </div>\n          <div className=\"w-full px-10 pt-10 pb-24 mt-6 bg-gray-100 rounded-3xl\">\n            <h1 className=\"mb-6 text-lg font-objetive-bold\">\n              {editable ? \"Editar usuario\" : \"Cargar nuevo usuario\"}\n            </h1>\n            <TextInput\n              placeholder=\"Nombre\"\n              eventHandler={onChangeName}\n              error={nameError}\n              value={name}\n            />\n\n            <div className=\"flex mt-8\">\n              <div className=\"w-full pr-4\">\n                <TextInput\n                  placeholder=\"Usuario\"\n                  eventHandler={onChangeUsername}\n                  error={usernameError}\n                  value={username}\n                />\n              </div>\n              <div className=\"w-full pl-4\">\n                <PasswordInput\n                  placeholder=\"Contraseña\"\n                  eventHandler={onChangePassword}\n                  error={passwordError}\n                  hide={hide}\n                  setHide={onSetHide}\n                  value={password}\n                />\n                <div className=\"pl-8 mt-4 text-sm text-left font-objetive-regular\">\n                  Debe tener al menos 8 caracteres\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex\">\n              <div className=\"w-full pr-4\">\n                <div className=\"font-objetive-medium\">Imagen de empresa</div>\n                <div className=\"mb-4 font-objetive-regular\">\n                  Formatos aceptados JPEG, JPG, PNG en 72 dpi.\n                </div>\n                <div {...getRootProps({ className: \"dropzone\" })}>\n                  <input {...getInputProps()} />\n                  <div className=\"flex items-center mr-10 cursor-pointer\">\n                    {img ? (\n                      <div className=\"mr-6 bg-gray-100 rounded-xl\">\n                        <img\n                          src={img}\n                          alt=\"Imagen\"\n                          className=\"object-contain w-20 h-20 rounded-xl\"\n                        />\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center justify-center w-20 h-20 mr-6 align-middle bg-gray-300 rounded-xl\">\n                        <CameraIcon className=\"z-10 w-10 h-10 text-gray-700\" />\n                      </div>\n                    )}\n\n                    <div>\n                      <h3 className=\"underline font-objetive-bold text-app-violet-300\">\n                        Seleccionar imágen\n                      </h3>\n                      <h4 className=\"text-sm text-gray-700 font-objetive-regular w-52\">\n                        {files.length > 0\n                          ? files\n                          : img\n                          ? img.replace(`${s3BucketUrl}/empresas/`, \"\")\n                          : \"No se selecciono imagen\"}\n                      </h4>\n                    </div>\n                  </div>\n                </div>\n                {files.length > 0 || img ? (\n                  <div\n                    onClick={deleteImg}\n                    className=\"flex items-center justify-center w-20 h-5 mt-2 bg-red-600 cursor-pointer rounded-xl\"\n                  >\n                    <TrashIcon className=\"w-4 h-4 text-white\" />\n                  </div>\n                ) : null}\n              </div>\n\n              <div className=\"w-full pl-10 mt-8\">\n                <div className=\"pl-4 mb-4 font-objetive-medium\">\n                  Tipo de usuario\n                </div>\n                <ItemSelector\n                  eventHandler={onChangeRole}\n                  data={roleData}\n                  value={role}\n                  text=\"Tipo\"\n                  error={roleError}\n                />\n              </div>\n            </div>\n\n            <button\n              type=\"button\"\n              onClick={onSubmit}\n              className=\"absolute inline-flex items-center px-4 pt-4 pb-3 text-base text-white border border-transparent rounded-full shadow-sm bottom--20 right-32 font-objetive-medium bg-app-purple-btn hover:bg-red-500 focus:outline-none \"\n            >\n              {editable ? \"Editar usuario\" : \"Guardar usuario\"}\n            </button>\n          </div>\n        </div>\n        <Table data={data} handleEdit={handleEdit} alert={alert} />\n      </>\n    );\n  }\n};\n\nexport default Users;\n"]},"metadata":{},"sourceType":"module"}