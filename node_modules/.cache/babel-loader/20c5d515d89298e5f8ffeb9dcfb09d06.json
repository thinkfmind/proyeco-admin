{"ast":null,"code":"var _jsxFileName = \"/Users/augusto/Desktop/proyeco-front/src/views/equipment/disponibility.js\",\n    _s = $RefreshSig$();\n\nimport { ChevronLeftIcon, DownloadIcon } from \"@heroicons/react/outline\";\nimport { useEffect, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport Navbar from \"../../@app/navbar\";\nimport { createChartRegisterBreackdown, createChartRegisterMantent } from \"../../helpers/chart\";\nimport { useSelector } from \"react-redux\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { getYear, sub, compareAsc } from 'date-fns';\nimport { capitalizeFirstLetter } from \"../../helpers/string\";\nimport { useState } from \"react\";\nimport { getValue } from \"../../helpers/table\";\nimport { backendUrl } from \"../../config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst dateActual = new Date();\nconst yearActual = getYear(dateActual);\nconst monthActual = capitalizeFirstLetter(dateActual.toLocaleString('es-ES', {\n  month: 'long'\n}));\nconst sixMonthPast = sub(dateActual, {\n  months: 6\n});\nconst yearPast = getYear(sixMonthPast);\nconst monthPast = capitalizeFirstLetter(sixMonthPast.toLocaleString('es-ES', {\n  month: 'long'\n}));\nlet chartBrackdown = null;\nlet chartMantent = null;\n\nconst Disponibility = () => {\n  _s();\n\n  const userSelector = useSelector(store => store.user);\n  const isEmpresa = userSelector.user.role === \"Empresa\";\n  const {\n    response: responseActividad\n  } = useFetch({\n    url: `${backendUrl}/actividad/${isEmpresa ? `empresa/${userSelector.user.id}` : \"\"}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`\n      }\n    },\n    initData: []\n  });\n  const {\n    response: responseEquipo\n  } = useFetch({\n    url: `${backendUrl}/equipo/${isEmpresa ? `empresa/${userSelector.user.id}` : \"\"}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`\n      }\n    },\n    initData: []\n  });\n  const {\n    response: responseUsers\n  } = useFetch({\n    url: `${backendUrl}/user`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`\n      }\n    },\n    initData: []\n  });\n  const [empresas, setEmpresas] = useState([]);\n  const refChartRegisterBreackdown = useRef(null);\n  const refChartRegisterMantent = useRef(null);\n  const refFicha = useRef(null);\n  const [dataActividad, setDataActividad] = useState([]);\n  const [equipos, setEquipos] = useState([]);\n  useEffect(() => {\n    if (responseActividad.length) {\n      setDataActividad(responseActividad);\n    }\n  }, [responseActividad]);\n  useEffect(() => {\n    if (responseEquipo.length) {\n      setEquipos(responseEquipo);\n    }\n  }, [responseEquipo]);\n  useEffect(() => {\n    let actividadesAverias = {\n      labels: [],\n      data: {}\n    };\n    let actividadesMantenimiento = {\n      labels: [],\n      data: {}\n    };\n\n    for (let i = 0; i < dataActividad.length; i++) {\n      const actividad = dataActividad[i];\n\n      if (compareAsc(new Date(actividad.fecha), sixMonthPast.setHours(0, 0, 0, 0)) === -1) {\n        continue;\n      }\n\n      if (compareAsc(dateActual.setHours(23, 59, 59), new Date(actividad.fecha)) === -1) {\n        continue;\n      }\n\n      if (actividad.tipo === \"Averías\") {\n        const activityName = `${actividad.equipo.name}-${actividad.linea.name}-${actividad.linea.lugar}-${actividad.estacion.name}`;\n        actividadesAverias.labels.push([actividad.equipo.name, actividad.estacion.name, `${actividad.linea.name} - ${actividad.linea.lugar}`]);\n\n        if (!actividadesAverias.data[activityName]) {\n          actividadesAverias.data[activityName] = 1;\n        } else {\n          actividadesAverias.data[activityName] += 1;\n        }\n\n        continue;\n      }\n\n      if (actividad.tipo.startsWith(\"Mantenimiento\")) {\n        const activityName = `${actividad.equipo.name}-${actividad.linea.name}-${actividad.linea.lugar}-${actividad.estacion.name}`;\n\n        if (!actividadesMantenimiento.data[activityName]) {\n          actividadesMantenimiento.labels.push([actividad.equipo.name, actividad.estacion.name, `${actividad.linea.name} - ${actividad.linea.lugar}`]);\n          actividadesMantenimiento.data[activityName] = 1;\n        } else {\n          actividadesMantenimiento.data[activityName] += 1;\n        }\n\n        continue;\n      }\n    }\n\n    if (chartBrackdown) {\n      chartBrackdown.destroy();\n    }\n\n    if (chartMantent) {\n      chartMantent.destroy();\n    }\n\n    chartBrackdown = createChartRegisterBreackdown(refChartRegisterBreackdown.current, actividadesAverias.labels, actividadesAverias.data);\n    chartMantent = createChartRegisterMantent(refChartRegisterMantent.current, actividadesMantenimiento.labels, actividadesMantenimiento.data);\n  }, [dataActividad]);\n  useEffect(() => {\n    if (responseUsers.length) {\n      const empresas = [];\n\n      for (let i = 0; i < responseUsers.length; i++) {\n        const user = responseUsers[i];\n\n        if (user.role.toUpperCase() === \"EMPRESA\") {\n          if (!empresas.find(empresa => empresa.id === user.id)) {\n            empresas.push({\n              name: user.name,\n              id: user.id\n            });\n          }\n        }\n      }\n\n      setEmpresas(empresas);\n    }\n  }, [responseUsers]);\n\n  const handleClickDownloadFicha = () => {\n    var w = refFicha.current.offsetWidth;\n    var h = refFicha.current.offsetHeight;\n    html2canvas(refFicha.current).then(canvas => {\n      const img = canvas.toDataURL('image/jpeg', 1);\n      const doc = new jsPDF('landscape', \"px\", [w, h]);\n      doc.addImage(img, 'JPEG', 0, 20, w, h);\n      doc.save('ficha.pdf');\n    });\n  };\n\n  const handleFilter = e => {\n    const selectValue = e.target.value;\n    let dataFilteredActividad = responseActividad;\n    let dataFilteredEquipo = responseEquipo;\n\n    if (selectValue) {\n      dataFilteredActividad = [...responseActividad].filter(actividad => {\n        const value = getValue(\"empresa.id\", actividad);\n        return value === selectValue;\n      });\n      dataFilteredEquipo = [...responseEquipo].filter(equipo => {\n        const value = getValue(\"empresa.id\", equipo);\n        return value === selectValue;\n      });\n    }\n\n    setDataActividad(dataFilteredActividad);\n    setEquipos(dataFilteredEquipo);\n  };\n\n  const calEquipInService = equipos => {\n    let countEquipInService = 0;\n    equipos.forEach(equipo => {\n      if (equipo.funciona) {\n        countEquipInService += 1;\n      }\n    });\n    return countEquipInService;\n  };\n\n  const equipmentInService = calEquipInService(equipos);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {\n        title: \"Disponibilidad de equipos\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute right-28 -bottom-12\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleClickDownloadFicha,\n          className: \"relative py-2 pl-10 pr-8 text-xs rounded-full font-objetive-medium bg-app-green-1 text-app-green-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-0 bottom-0 left-0 flex items-center\",\n            children: /*#__PURE__*/_jsxDEV(DownloadIcon, {\n              className: \"w-8 h-8 p-2 text-white rounded-full bg-app-green-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 7\n          }, this), \"Descargar ficha\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-20 pt-14 vp-desktop\",\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/equipment\",\n        className: \"flex font-objetive-medium\",\n        children: [/*#__PURE__*/_jsxDEV(ChevronLeftIcon, {\n          className: \"w-5 h-5 mr-2 text-gray-700\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 6\n        }, this), \"Volver\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: refFicha,\n      className: \"px-20 pb-10 vp-desktop font-objetive-regular\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-center mb-10 space-x-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: isEmpresa ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"flex items-center justify-center h-10 px-10 text-white rounded-full bg-app-purple-300\",\n            children: userSelector.user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 8\n          }, this) : /*#__PURE__*/_jsxDEV(\"select\", {\n            onChange: handleFilter,\n            className: \"flex items-center justify-center text-center text-white rounded-full h-14 bg-app-purple-300\",\n            style: {\n              textAlignLast: \"center\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Todas las empresas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 9\n            }, this), empresas.map(empresa => {\n              return /*#__PURE__*/_jsxDEV(\"option\", {\n                value: empresa.id,\n                children: empresa.name\n              }, `empresa-${empresa.id}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 17\n              }, this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 py-4 rounded-3xl bg-app-purple-100 text-app-purple-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"py-2 pl-10 pr-6 border-r border-app-purple-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-3xl font-objetive-bold\",\n              children: [Math.round(equipmentInService * 100 / equipos.length) || 0, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm\",\n              children: \"equipos en servicio\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col justify-center py-4 pl-10 pr-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-objetive-bold\",\n              children: [equipmentInService, \"/\", equipos.length]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm\",\n              children: \"equipos totales\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-12 gap-x-12\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full col-span-7 p-6 bg-gray-100 rounded-3xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col items-end\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-objetive-bold\",\n                children: \"Registro de aver\\xEDas\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: `(${monthPast} ${yearPast} a ${monthActual} ${yearActual})`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mb-6 text-xs text-black font-objetive-medium\",\n              children: \"Aver\\xEDas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n              className: \"ml-2\",\n              ref: refChartRegisterBreackdown,\n              id: \"chartRegisterBreackdown\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col w-full col-span-5 p-6 bg-gray-100 rounded-3xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col items-end\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-objetive-bold\",\n                children: \"Registro mantenimientos correctivos\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: `(${monthPast} ${yearPast} a ${monthActual} ${yearActual})`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center flex-grow\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mr-4\",\n              id: \"legend-container-registerMantent\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"flex flex-col items-center justify-center space-y-6 text-xs font-objetive-medium ul-chart\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n                ref: refChartRegisterMantent,\n                id: \"chartRegisterMantent\",\n                height: \"300\",\n                width: \"200\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Disponibility, \"eKXCXaN/C/ZnxiZv4V9lHDpYLr4=\", false, function () {\n  return [useSelector, useFetch, useFetch, useFetch];\n});\n\n_c = Disponibility;\nexport default Disponibility;\n\nvar _c;\n\n$RefreshReg$(_c, \"Disponibility\");","map":{"version":3,"sources":["/Users/augusto/Desktop/proyeco-front/src/views/equipment/disponibility.js"],"names":["ChevronLeftIcon","DownloadIcon","useEffect","useRef","Link","jsPDF","html2canvas","Navbar","createChartRegisterBreackdown","createChartRegisterMantent","useSelector","useFetch","getYear","sub","compareAsc","capitalizeFirstLetter","useState","getValue","backendUrl","dateActual","Date","yearActual","monthActual","toLocaleString","month","sixMonthPast","months","yearPast","monthPast","chartBrackdown","chartMantent","Disponibility","userSelector","store","user","isEmpresa","role","response","responseActividad","url","id","options","headers","Authorization","jwtToken","initData","responseEquipo","responseUsers","empresas","setEmpresas","refChartRegisterBreackdown","refChartRegisterMantent","refFicha","dataActividad","setDataActividad","equipos","setEquipos","length","actividadesAverias","labels","data","actividadesMantenimiento","i","actividad","fecha","setHours","tipo","activityName","equipo","name","linea","lugar","estacion","push","startsWith","destroy","current","toUpperCase","find","empresa","handleClickDownloadFicha","w","offsetWidth","h","offsetHeight","then","canvas","img","toDataURL","doc","addImage","save","handleFilter","e","selectValue","target","value","dataFilteredActividad","dataFilteredEquipo","filter","calEquipInService","countEquipInService","forEach","funciona","equipmentInService","textAlignLast","map","Math","round"],"mappings":"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","sourcesContent":["import { ChevronLeftIcon, DownloadIcon } from \"@heroicons/react/outline\"\nimport { useEffect, useRef } from \"react\"\nimport { Link } from \"react-router-dom\"\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport Navbar from \"../../@app/navbar\"\nimport { createChartRegisterBreackdown, createChartRegisterMantent } from \"../../helpers/chart\"\nimport { useSelector } from \"react-redux\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { getYear, sub, compareAsc } from 'date-fns'\nimport { capitalizeFirstLetter } from \"../../helpers/string\";\nimport { useState } from \"react\";\nimport { getValue } from \"../../helpers/table\";\nimport { backendUrl } from \"../../config\";\n\nconst dateActual = new Date()\nconst yearActual = getYear(dateActual)\nconst monthActual = capitalizeFirstLetter(dateActual.toLocaleString('es-ES', { month: 'long' }))\nconst sixMonthPast = sub(dateActual, { months: 6 })\nconst yearPast = getYear(sixMonthPast)\nconst monthPast = capitalizeFirstLetter(sixMonthPast.toLocaleString('es-ES', { month: 'long' }))\n\nlet chartBrackdown = null\nlet chartMantent = null\n\nconst Disponibility = () => {\n  const userSelector = useSelector((store) => store.user);\n\tconst isEmpresa = userSelector.user.role === \"Empresa\"\n\tconst { response: responseActividad } = useFetch({\n    url: `${backendUrl}/actividad/${isEmpresa ? `empresa/${userSelector.user.id}` : \"\"}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`,\n      },\n    },\n\t\tinitData: []\n  });\n\tconst { response: responseEquipo } = useFetch({\n\t\turl: `${backendUrl}/equipo/${isEmpresa ? `empresa/${userSelector.user.id}` : \"\"}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`,\n      },\n    },\n\t\tinitData: []\n\t})\n\tconst { response: responseUsers } = useFetch({\n\t\turl: `${backendUrl}/user`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`,\n      },\n    },\n\t\tinitData: []\n\t})\n\tconst [empresas, setEmpresas] = useState([])\n\tconst refChartRegisterBreackdown = useRef(null)\n\tconst refChartRegisterMantent = useRef(null)\n\tconst refFicha = useRef(null)\n\tconst [dataActividad, setDataActividad] = useState([])\n\tconst [equipos, setEquipos] = useState([])\n\n\tuseEffect(() => {\n\t\tif (responseActividad.length) {\n\t\t\tsetDataActividad(responseActividad)\n\t\t}\n\t}, [responseActividad])\n\n\tuseEffect(() => {\n\t\tif (responseEquipo.length) {\n\t\t\tsetEquipos(responseEquipo)\n\t\t}\n\t}, [responseEquipo])\n\n\tuseEffect(() => {\n\t\tlet actividadesAverias = {\n\t\t\tlabels: [],\n\t\t\tdata: {}\n\t\t}\n\t\tlet actividadesMantenimiento = {\n\t\t\tlabels: [],\n\t\t\tdata: {}\n\t\t}\n\t\tfor (let i = 0; i < dataActividad.length; i++) {\n\t\t\tconst actividad = dataActividad[i];\n\t\t\tif (compareAsc(new Date(actividad.fecha), sixMonthPast.setHours(0, 0, 0, 0)) === -1) {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tif (compareAsc(dateActual.setHours(23, 59, 59), new Date(actividad.fecha)) === -1) {\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tif (actividad.tipo === \"Averías\") {\n\t\t\t\tconst activityName = `${actividad.equipo.name}-${actividad.linea.name}-${actividad.linea.lugar}-${actividad.estacion.name}`\n\t\t\t\tactividadesAverias.labels.push([actividad.equipo.name, actividad.estacion.name, `${actividad.linea.name} - ${actividad.linea.lugar}`])\n\t\t\t\tif (!actividadesAverias.data[activityName]) {\n\t\t\t\t\tactividadesAverias.data[activityName] = 1\n\t\t\t\t} else {\n\t\t\t\t\tactividadesAverias.data[activityName] += 1\n\t\t\t\t}\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tif (actividad.tipo.startsWith(\"Mantenimiento\")) {\n\t\t\t\tconst activityName = `${actividad.equipo.name}-${actividad.linea.name}-${actividad.linea.lugar}-${actividad.estacion.name}`\n\t\t\t\tif (!actividadesMantenimiento.data[activityName]) {\n\t\t\t\t\tactividadesMantenimiento.labels.push([actividad.equipo.name, actividad.estacion.name, `${actividad.linea.name} - ${actividad.linea.lugar}`])\n\t\t\t\t\tactividadesMantenimiento.data[activityName] = 1\n\t\t\t\t} else {\n\t\t\t\t\tactividadesMantenimiento.data[activityName] += 1\n\t\t\t\t}\n\t\t\t\tcontinue\n\t\t\t}\n\t\t}\n\t\tif (chartBrackdown) {\n\t\t\tchartBrackdown.destroy()\n\t\t}\n\t\tif (chartMantent) {\n\t\t\tchartMantent.destroy()\n\t\t}\n\t\tchartBrackdown = createChartRegisterBreackdown(refChartRegisterBreackdown.current, actividadesAverias.labels, actividadesAverias.data)\n\t\tchartMantent = createChartRegisterMantent(refChartRegisterMantent.current, actividadesMantenimiento.labels, actividadesMantenimiento.data)\n\t}, [dataActividad])\n\n\tuseEffect(() => {\n    if (responseUsers.length) {\n      const empresas = [];\n      for (let i = 0; i < responseUsers.length; i++) {\n        const user = responseUsers[i];\n        if (user.role.toUpperCase() === \"EMPRESA\") {\n          if (!empresas.find((empresa) => empresa.id === user.id)) {\n            empresas.push({\n\t\t\t\t\t\t\tname: user.name,\n\t\t\t\t\t\t\tid: user.id\n\t\t\t\t\t\t});\n          }\n        }\n      }\n      setEmpresas(empresas);\n    }\n  }, [responseUsers]);\n\n\tconst handleClickDownloadFicha = () => {\n\t\tvar w = refFicha.current.offsetWidth;\n\t\tvar h = refFicha.current.offsetHeight;\n\t\thtml2canvas(refFicha.current).then((canvas) => {\n\t\t\tconst img=canvas.toDataURL('image/jpeg', 1);\n\t\t\tconst doc = new jsPDF('landscape', \"px\", [w, h]);\n\t\t\tdoc.addImage(img,'JPEG',0,20, w, h);\n\t\t\tdoc.save('ficha.pdf');\n\t\t})\n\t}\n\n\tconst handleFilter = (e) => {\n\t\tconst selectValue = e.target.value\n\t\tlet dataFilteredActividad = responseActividad;\n\t\tlet dataFilteredEquipo = responseEquipo;\n\n    if (selectValue) {\n      dataFilteredActividad = [...responseActividad].filter((actividad) => {\n        const value = getValue(\"empresa.id\", actividad);\n        return value === selectValue;\n      });\n\t\t\tdataFilteredEquipo = [...responseEquipo].filter((equipo) => {\n        const value = getValue(\"empresa.id\", equipo);\n        return value === selectValue;\n      });\n    }\n    setDataActividad(dataFilteredActividad);\n    setEquipos(dataFilteredEquipo);\n\t}\n\n\tconst calEquipInService = (equipos) => {\n\t\tlet countEquipInService = 0\n\t\tequipos.forEach(equipo => {\n\t\t\tif (equipo.funciona) {\n\t\t\t\tcountEquipInService += 1\n\t\t\t}\n\t\t});\n\t\treturn countEquipInService\n\t}\n\n\tconst equipmentInService = calEquipInService(equipos)\n\treturn (\n\t\t<>\n      <div className=\"relative\">\n\t\t\t\t<Navbar title=\"Disponibilidad de equipos\" />\n        <div className=\"absolute right-28 -bottom-12\">\n\t\t\t\t\t<button onClick={handleClickDownloadFicha} className=\"relative py-2 pl-10 pr-8 text-xs rounded-full font-objetive-medium bg-app-green-1 text-app-green-3\">\n\t\t\t\t\t\t<div className=\"absolute top-0 bottom-0 left-0 flex items-center\">\n\t\t\t\t\t\t\t<DownloadIcon className=\"w-8 h-8 p-2 text-white rounded-full bg-app-green-3\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\tDescargar ficha\n\t\t\t\t\t</button>\n        </div>\n\t\t\t</div>\n\t\t\t<div className=\"px-20 pt-14 vp-desktop\">\n\t\t\t\t<Link to=\"/equipment\" className=\"flex font-objetive-medium\">\n\t\t\t\t\t<ChevronLeftIcon className=\"w-5 h-5 mr-2 text-gray-700\" />\n\t\t\t\t\tVolver\n\t\t\t\t</Link>\n\t\t\t</div>\n\t\t\t<div ref={refFicha} className=\"px-20 pb-10 vp-desktop font-objetive-regular\">\n\t\t\t\t<div className=\"flex items-center justify-center mb-10 space-x-8\">\n\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t{isEmpresa ? (\n\t\t\t\t\t\t\t<p className=\"flex items-center justify-center h-10 px-10 text-white rounded-full bg-app-purple-300\">{userSelector.user.name}</p>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<select onChange={handleFilter} className=\"flex items-center justify-center text-center text-white rounded-full h-14 bg-app-purple-300\" style={{ textAlignLast: \"center\" }}>\n\t\t\t\t\t\t\t\t<option value=\"\">Todas las empresas</option>\n\t\t\t\t\t\t\t\t{empresas.map((empresa) => {\n\t\t\t\t\t\t\t\t\treturn <option key={`empresa-${empresa.id}`} value={empresa.id}>{empresa.name}</option>\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"grid grid-cols-2 py-4 rounded-3xl bg-app-purple-100 text-app-purple-300\">\n\t\t\t\t\t\t<div className=\"py-2 pl-10 pr-6 border-r border-app-purple-300\">\n\t\t\t\t\t\t\t<p className=\"text-3xl font-objetive-bold\">{Math.round(((equipmentInService * 100) / equipos.length)) || 0}%</p>\n\t\t\t\t\t\t\t<p className=\"text-sm\">equipos en servicio</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex flex-col justify-center py-4 pl-10 pr-6\">\n\t\t\t\t\t\t\t<p className=\"text-lg font-objetive-bold\">{equipmentInService}/{equipos.length}</p>\n\t\t\t\t\t\t\t<p className=\"text-sm\">equipos totales</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"grid grid-cols-12 gap-x-12\">\n\t\t\t\t\t<div className=\"w-full col-span-7 p-6 bg-gray-100 rounded-3xl\">\n\t\t\t\t\t\t<div className=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t<p className=\"font-objetive-bold\">Registro de averías</p>\n\t\t\t\t\t\t\t\t<p className=\"text-sm\">{`(${monthPast} ${yearPast} a ${monthActual} ${yearActual})`}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p className=\"mb-6 text-xs text-black font-objetive-medium\">Averías</p>\n\t\t\t\t\t\t\t<canvas className=\"ml-2\" ref={refChartRegisterBreackdown} id=\"chartRegisterBreackdown\"></canvas>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex flex-col w-full col-span-5 p-6 bg-gray-100 rounded-3xl\">\n\t\t\t\t\t\t<div className=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t<p className=\"font-objetive-bold\">Registro mantenimientos correctivos</p>\n\t\t\t\t\t\t\t\t<p className=\"text-sm\">{`(${monthPast} ${yearPast} a ${monthActual} ${yearActual})`}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex items-center justify-center flex-grow\">\n\t\t\t\t\t\t\t<div className=\"mr-4\" id=\"legend-container-registerMantent\">\n\t\t\t\t\t\t\t\t<ul className=\"flex flex-col items-center justify-center space-y-6 text-xs font-objetive-medium ul-chart\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t\t<canvas ref={refChartRegisterMantent} id=\"chartRegisterMantent\" height=\"300\" width=\"200\"></canvas>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t)\n}\n\nexport default Disponibility\n"]},"metadata":{},"sourceType":"module"}