{"ast":null,"code":"var _jsxFileName = \"/Users/augusto/Desktop/proyeco-front/src/components/home/equipo/description.js\",\n    _s = $RefreshSig$();\n\nimport { DownloadIcon, XIcon, LocationMarkerIcon, DocumentDownloadIcon } from \"@heroicons/react/outline\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport { createChartCountBreackdown, createChartEquip } from \"../../../helpers/chart\";\nimport { useSelector } from \"react-redux\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport Noimg from \"../../../assets/img/noimg.png\";\nimport useFetch from \"../../../hooks/useFetch\";\nimport { getYear, getMonth } from \"date-fns\";\nimport { backendUrl, s3BucketUrl } from '../../../config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst yearNow = getYear(new Date());\n\nconst Description = _ref => {\n  _s();\n\n  let {\n    id,\n    closeHandler,\n    hidex\n  } = _ref;\n  const userSelector = useSelector(store => store.user);\n  const refChartCountBreackdown = useRef(null);\n  const refChartEquip = useRef(null);\n  const refFicha = useRef(null);\n  const [data, setData] = useState([]);\n  const {\n    response: responseActividad\n  } = useFetch({\n    url: `${backendUrl}/actividad/equipo/${id}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`\n      }\n    },\n    initData: []\n  });\n  const [img1, setImg1] = useState(\"\");\n  const [img2, setImg2] = useState(\"\");\n  const [img3, setImg3] = useState(\"\");\n  const [percentagePositiveAverias, setPercentagePositiveAverias] = useState(0);\n  const [percentageBalancePositive, setPercentageBalancePositive] = useState(0);\n\n  const onErrorImg1 = () => {\n    setImg1(Noimg);\n  };\n\n  const onErrorImg2 = () => {\n    setImg2(Noimg);\n  };\n\n  const onErrorImg3 = () => {\n    setImg3(Noimg);\n  };\n\n  const consult = async source => {\n    const res = await axios.get(`${backendUrl}/equipo/${id}`, {\n      cancelToken: source.token,\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`\n      }\n    });\n    const date = new Date(res.data.updatedAt);\n    const dif = Date.now() - date.getTime();\n    const days = Math.round(dif / 86400000);\n    res.data.updatedAt = days;\n    setData(res.data);\n    setImg1(res.data.imagenUno);\n    setImg2(res.data.imagenDos);\n    setImg3(res.data.imagenTres);\n  };\n\n  const handleClickDownloadFicha = () => {\n    var w = refFicha.current.offsetWidth;\n    var h = refFicha.current.offsetHeight;\n    const shadowElements = document.querySelectorAll(\".shadow-md\");\n    shadowElements.forEach(element => {\n      element.classList.remove(\"shadow-md\");\n    });\n    html2canvas(refFicha.current, {\n      useCORS: true\n    }).then(canvas => {\n      const img = canvas.toDataURL(\"image/jpeg\", 1);\n      const doc = new jsPDF(\"landscape\", \"px\", [w, h]);\n      doc.addImage(img, \"JPEG\", 0, 0, w, h);\n      doc.save(\"ficha.pdf\");\n      shadowElements.forEach(element => {\n        element.classList.add(\"shadow-md\");\n      });\n    });\n  };\n\n  const handleClickDownloadHistorico = () => {\n    if (data.historico) {\n      window.open(`${s3BucketUrl}/${data.historico}`, \"_blank\");\n    }\n  };\n\n  useEffect(() => {\n    let source = axios.CancelToken.source();\n    consult(source);\n    return () => {\n      source.cancel();\n    };\n  }, []);\n  useEffect(() => {\n    if (!refChartCountBreackdown.current.classList.contains(\"active-chart\") && responseActividad.length) {\n      refChartCountBreackdown.current.classList.add(\"active-chart\");\n      let actividadesAveriasMonth = [];\n      let actividadesMantenimientoCorrectivoMonth = [];\n      let actividadesMantenimientoPreventivoMonth = [];\n\n      for (let i = 0; i < responseActividad.length; i++) {\n        const actividad = responseActividad[i];\n        const fechaActividad = new Date(actividad.fecha);\n        const yearActivity = getYear(fechaActividad);\n\n        if (yearActivity === yearNow) {\n          const monthActivity = getMonth(fechaActividad);\n\n          if (actividad.tipo === \"Averías\") {\n            if (!actividadesAveriasMonth[monthActivity]) {\n              actividadesAveriasMonth[monthActivity] = 1;\n            } else {\n              actividadesAveriasMonth[monthActivity] += 1;\n            }\n\n            continue;\n          }\n\n          if (actividad.tipo === \"Mantenimiento correctivo\") {\n            if (!actividadesMantenimientoCorrectivoMonth[monthActivity]) {\n              actividadesMantenimientoCorrectivoMonth[monthActivity] = 1;\n            } else {\n              actividadesMantenimientoCorrectivoMonth[monthActivity] += 1;\n            }\n          }\n\n          if (actividad.tipo === \"Mantenimiento preventivo\") {\n            if (!actividadesMantenimientoPreventivoMonth[monthActivity]) {\n              actividadesMantenimientoPreventivoMonth[monthActivity] = 1;\n            } else {\n              actividadesMantenimientoPreventivoMonth[monthActivity] += 1;\n            }\n          }\n        }\n      }\n\n      const CANT_CORRECT_AVERIAS = 3;\n      const TOTAL_PERCENTAGE = 100;\n      const COUNT_MONTHS = 12;\n      const percentage = Array.from({\n        length: COUNT_MONTHS\n      }, () => TOTAL_PERCENTAGE);\n      const percentageBalance = Array.from({\n        length: COUNT_MONTHS\n      }, () => TOTAL_PERCENTAGE);\n      actividadesAveriasMonth.forEach((averias, i) => {\n        if (averias >= 4) {\n          const INIT_VALUE_PROBLEM_PERCENTAGE = 18;\n          const countMentenimientoPreventivo = actividadesMantenimientoPreventivoMonth[i];\n          const countMentenimientoCorrectivo = actividadesMantenimientoCorrectivoMonth[i];\n          const averiasProblem = averias - CANT_CORRECT_AVERIAS;\n          let solutionAverias = 0;\n          let totalProblemPercentage = 0;\n          let totalBalancePercentage = 0;\n          solutionAverias = averiasProblem - countMentenimientoCorrectivo - countMentenimientoPreventivo / 2;\n\n          if (solutionAverias > 0) {\n            for (let i = 1; i <= solutionAverias; i++) {\n              totalBalancePercentage += INIT_VALUE_PROBLEM_PERCENTAGE / i;\n            }\n          }\n\n          for (let i = 1; i <= averiasProblem; i++) {\n            totalProblemPercentage += INIT_VALUE_PROBLEM_PERCENTAGE / i;\n          }\n\n          const newPercentage = TOTAL_PERCENTAGE - totalProblemPercentage;\n          percentage[i] = newPercentage;\n          percentageBalance[i] = TOTAL_PERCENTAGE - totalBalancePercentage;\n        }\n      });\n      let balancePercentage = 0;\n      let balancePositivePercentage = 0;\n      percentage.forEach(monthPercentage => {\n        balancePercentage += monthPercentage;\n      });\n      percentageBalance.forEach(monthPercentage => {\n        balancePositivePercentage += monthPercentage;\n      });\n      setPercentageBalancePositive(balancePositivePercentage / COUNT_MONTHS);\n      setPercentagePositiveAverias(balancePercentage / COUNT_MONTHS);\n      createChartCountBreackdown(refChartCountBreackdown.current, {\n        preventivo: actividadesMantenimientoPreventivoMonth,\n        correctivo: actividadesMantenimientoCorrectivoMonth,\n        averias: actividadesAveriasMonth\n      });\n      createChartEquip(refChartEquip.current, actividadesAveriasMonth);\n    }\n  }, [responseActividad]);\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    ref: refFicha,\n    className: \"relative w-full px-6 pt-4 pb-12 my-6 bg-gray-100 hola rounded-3xl font-objetive-regular\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-end\",\n      children: [userSelector.user.role === \"Admin\" ? /*#__PURE__*/_jsxDEV(Link, {\n        to: {\n          pathname: \"/equipment/edit\",\n          state: {\n            id: id\n          }\n        },\n        className: \"mt-4 mr-6 text-base underline table-autofont-objetive-bold\",\n        children: \"Editar equipo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }, this) : null, hidex ? null : /*#__PURE__*/_jsxDEV(\"button\", {\n        children: /*#__PURE__*/_jsxDEV(XIcon, {\n          className: \"w-6 h-6 mt-4 text-gray-400\",\n          onClick: () => {\n            closeHandler(\"\", \"\");\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-10\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-3xl font-objetive-bold text-app-green-3\",\n        children: data.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"grid grid-cols-2 px-10 gap-x-16\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center my-3\",\n          children: [/*#__PURE__*/_jsxDEV(LocationMarkerIcon, {\n            className: \"w-4 h-4 mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [data.linea ? data.linea.name : \"\", \" -\", \" \", data.linea ? data.linea.lugar : \"\", \" -\", \" \", data.estacion ? data.estacion.name : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          className: `mb-2 font-objetive-bold ${data.funciona ? \"text-green-700\" : \"text-app-red-2\"}`,\n          children: [data.estado, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-black font-objetive-regular\",\n            children: data.funciona ? \"\" : ` ·  dias inactivo`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-3 mb-3 gap-x-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-2\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"object-cover w-full h-full rounded-xl\",\n              src: img1,\n              alt: \"Imagen1\",\n              onError: onErrorImg1,\n              crossOrigin: \"anonymous\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 gap-y-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"object-cover w-full h-full rounded-xl \",\n                src: img2,\n                alt: \"Imagen2\",\n                onError: onErrorImg2,\n                crossOrigin: \"anonymous\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"object-cover w-full h-full rounded-xl\",\n                src: img3,\n                alt: \"Imagen3\",\n                onError: onErrorImg3,\n                crossOrigin: \"anonymous\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6 text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"N de identificaci\\xF3n: \", data.identificacion]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Modelo \", data.modelo]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"my-3\",\n            children: data.detalles\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-app-green-4\",\n            children: [\"A cargo de \", data.empresa ? data.empresa.name : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mb-2 font-objetive-bold\",\n            children: \"Mantenimientos del \\xFAltimo mes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this), responseActividad.length > 0 ? responseActividad.slice(0, 3).map(actividad => {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pt-2 mt-2 space-y-1 border-t border-gray-400\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"font-objetive-medium\",\n                children: actividad.tipo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs\",\n                children: \"Fecha de registro - 17/07/2021\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs\",\n                children: [actividad.dias, \" \", actividad.dias === 1 ? \"día\" : \"días\", \" \", \"parado en reparaci\\xF3n\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 21\n              }, this)]\n            }, actividad.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 19\n            }, this);\n          }) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pt-2 mt-2 space-y-1 border-t border-gray-400\",\n            children: /*#__PURE__*/_jsxDEV(\"h5\", {\n              className: \"font-objetive-medium\",\n              children: \"No registra actividad\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mb-4 text-sm\",\n            children: \"Cantidad de aver\\xEDas\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full p-6 bg-white shadow-md rounded-3xl\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-3 \",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-span-2\",\n                children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n                  ref: refChartCountBreackdown,\n                  id: \"chartCantBreackdown\",\n                  height: \"250\",\n                  width: \"250\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 336,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col items-center justify-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-3xl font-objetive-bold text-app-green-3\",\n                  children: [percentageBalancePositive, \" %\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 345,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-objetive-regular\",\n                  children: \"Balance positivo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 348,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-8 mt-8\",\n              id: \"legend-container\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"flex flex-col space-y-2 text-xs font-objetive-medium ul-chart\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 354,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-10 mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mb-4 text-sm\",\n            children: \"Rendimiento general del equipo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid w-full grid-cols-3 p-6 bg-white shadow-md rounded-3xl\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-span-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mb-6 ml-4 text-xs text-black font-objetive-medium\",\n                children: \"Aver\\xEDas totales\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n                className: \"ml-10\",\n                ref: refChartEquip,\n                id: \"chartEquip\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col items-center justify-center text-black\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col items-center justify-center w-32 h-32 border rounded-full border-app-red-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-3xl font-objetive-bold\",\n                  children: [percentagePositiveAverias, \" %\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-objetive-regular\",\n                  children: \"Positivo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 376,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleClickDownloadFicha,\n            className: \"relative py-1 mr-6 text-xs rounded-full font-objetive-medium px-7 bg-app-green-1 text-app-green-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 bottom-0 left-0 flex items-center\",\n              children: /*#__PURE__*/_jsxDEV(DownloadIcon, {\n                className: \"w-6 h-6 p-1 text-white rounded-full bg-app-green-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 15\n            }, this), \"Descargar ficha\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleClickDownloadHistorico,\n            className: \"relative py-1 text-xs rounded-full font-objetive-medium px-7 bg-app-green-1 text-app-green-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 bottom-0 flex items-center -left-1\",\n              children: /*#__PURE__*/_jsxDEV(DocumentDownloadIcon, {\n                className: \"w-6 h-6 p-1 text-white rounded-full bg-app-green-3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 15\n            }, this), \"Descargar datos hist\\xF3ricos\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Description, \"GQQf91erWpFLZ0e00CcsY56D5AA=\", false, function () {\n  return [useSelector, useFetch];\n});\n\n_c = Description;\nexport default Description;\n\nvar _c;\n\n$RefreshReg$(_c, \"Description\");","map":{"version":3,"sources":["/Users/augusto/Desktop/proyeco-front/src/components/home/equipo/description.js"],"names":["DownloadIcon","XIcon","LocationMarkerIcon","DocumentDownloadIcon","useEffect","useRef","useState","jsPDF","html2canvas","createChartCountBreackdown","createChartEquip","useSelector","axios","Link","Noimg","useFetch","getYear","getMonth","backendUrl","s3BucketUrl","yearNow","Date","Description","id","closeHandler","hidex","userSelector","store","user","refChartCountBreackdown","refChartEquip","refFicha","data","setData","response","responseActividad","url","options","headers","Authorization","jwtToken","initData","img1","setImg1","img2","setImg2","img3","setImg3","percentagePositiveAverias","setPercentagePositiveAverias","percentageBalancePositive","setPercentageBalancePositive","onErrorImg1","onErrorImg2","onErrorImg3","consult","source","res","get","cancelToken","token","date","updatedAt","dif","now","getTime","days","Math","round","imagenUno","imagenDos","imagenTres","handleClickDownloadFicha","w","current","offsetWidth","h","offsetHeight","shadowElements","document","querySelectorAll","forEach","element","classList","remove","useCORS","then","canvas","img","toDataURL","doc","addImage","save","add","handleClickDownloadHistorico","historico","window","open","CancelToken","cancel","contains","length","actividadesAveriasMonth","actividadesMantenimientoCorrectivoMonth","actividadesMantenimientoPreventivoMonth","i","actividad","fechaActividad","fecha","yearActivity","monthActivity","tipo","CANT_CORRECT_AVERIAS","TOTAL_PERCENTAGE","COUNT_MONTHS","percentage","Array","from","percentageBalance","averias","INIT_VALUE_PROBLEM_PERCENTAGE","countMentenimientoPreventivo","countMentenimientoCorrectivo","averiasProblem","solutionAverias","totalProblemPercentage","totalBalancePercentage","newPercentage","balancePercentage","balancePositivePercentage","monthPercentage","preventivo","correctivo","role","pathname","state","name","linea","lugar","estacion","funciona","estado","identificacion","modelo","detalles","empresa","slice","map","dias"],"mappings":"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","sourcesContent":["import {\n  DownloadIcon,\n  XIcon,\n  LocationMarkerIcon,\n  DocumentDownloadIcon,\n} from \"@heroicons/react/outline\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport {\n  createChartCountBreackdown,\n  createChartEquip,\n} from \"../../../helpers/chart\";\nimport { useSelector } from \"react-redux\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport Noimg from \"../../../assets/img/noimg.png\";\nimport useFetch from \"../../../hooks/useFetch\";\nimport { getYear, getMonth } from \"date-fns\";\nimport {backendUrl, s3BucketUrl} from '../../../config'\n\nconst yearNow = getYear(new Date());\n\nconst Description = ({ id, closeHandler, hidex }) => {\n  const userSelector = useSelector((store) => store.user);\n  const refChartCountBreackdown = useRef(null);\n  const refChartEquip = useRef(null);\n  const refFicha = useRef(null);\n  const [data, setData] = useState([]);\n  const { response: responseActividad } = useFetch({\n    url: `${backendUrl}/actividad/equipo/${id}`,\n    options: {\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`,\n      },\n    },\n    initData: [],\n  });\n  const [img1, setImg1] = useState(\"\");\n  const [img2, setImg2] = useState(\"\");\n  const [img3, setImg3] = useState(\"\");\n  const [percentagePositiveAverias, setPercentagePositiveAverias] = useState(0);\n  const [percentageBalancePositive, setPercentageBalancePositive] = useState(0);\n\n  const onErrorImg1 = () => {\n    setImg1(Noimg);\n  };\n\n  const onErrorImg2 = () => {\n    setImg2(Noimg);\n  };\n\n  const onErrorImg3 = () => {\n    setImg3(Noimg);\n  };\n\n  const consult = async (source) => {\n    const res = await axios.get(`${backendUrl}/equipo/${id}`, {\n      cancelToken: source.token,\n      headers: {\n        Authorization: `Bearer ${userSelector.user.jwtToken}`,\n      },\n    });\n    const date = new Date(res.data.updatedAt);\n    const dif = Date.now() - date.getTime();\n    const days = Math.round(dif / 86400000);\n    res.data.updatedAt = days;\n    setData(res.data);\n\n    setImg1(res.data.imagenUno);\n    setImg2(res.data.imagenDos);\n    setImg3(res.data.imagenTres);\n  };\n\n  const handleClickDownloadFicha = () => {\n    var w = refFicha.current.offsetWidth;\n    var h = refFicha.current.offsetHeight;\n    const shadowElements = document.querySelectorAll(\".shadow-md\");\n    shadowElements.forEach((element) => {\n      element.classList.remove(\"shadow-md\");\n    });\n    html2canvas(refFicha.current, { useCORS: true }).then((canvas) => {\n      const img = canvas.toDataURL(\"image/jpeg\", 1);\n      const doc = new jsPDF(\"landscape\", \"px\", [w, h]);\n      doc.addImage(img, \"JPEG\", 0, 0, w, h);\n      doc.save(\"ficha.pdf\");\n\n      shadowElements.forEach((element) => {\n        element.classList.add(\"shadow-md\");\n      });\n    });\n  };\n\n  const handleClickDownloadHistorico = () => {\n    if (data.historico) {\n      window.open(\n        `${s3BucketUrl}/${data.historico}`,\n        \"_blank\"\n      );\n    }\n  };\n\n  useEffect(() => {\n    let source = axios.CancelToken.source();\n    consult(source);\n\n    return () => {\n      source.cancel();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      !refChartCountBreackdown.current.classList.contains(\"active-chart\") &&\n      responseActividad.length\n    ) {\n      refChartCountBreackdown.current.classList.add(\"active-chart\");\n      let actividadesAveriasMonth = [];\n      let actividadesMantenimientoCorrectivoMonth = [];\n      let actividadesMantenimientoPreventivoMonth = [];\n      for (let i = 0; i < responseActividad.length; i++) {\n        const actividad = responseActividad[i];\n        const fechaActividad = new Date(actividad.fecha);\n        const yearActivity = getYear(fechaActividad);\n        if (yearActivity === yearNow) {\n          const monthActivity = getMonth(fechaActividad);\n          if (actividad.tipo === \"Averías\") {\n            if (!actividadesAveriasMonth[monthActivity]) {\n              actividadesAveriasMonth[monthActivity] = 1;\n            } else {\n              actividadesAveriasMonth[monthActivity] += 1;\n            }\n            continue;\n          }\n          if (actividad.tipo === \"Mantenimiento correctivo\") {\n            if (!actividadesMantenimientoCorrectivoMonth[monthActivity]) {\n              actividadesMantenimientoCorrectivoMonth[monthActivity] = 1;\n            } else {\n              actividadesMantenimientoCorrectivoMonth[monthActivity] += 1;\n            }\n          }\n          if (actividad.tipo === \"Mantenimiento preventivo\") {\n            if (!actividadesMantenimientoPreventivoMonth[monthActivity]) {\n              actividadesMantenimientoPreventivoMonth[monthActivity] = 1;\n            } else {\n              actividadesMantenimientoPreventivoMonth[monthActivity] += 1;\n            }\n          }\n        }\n      }\n      const CANT_CORRECT_AVERIAS = 3;\n      const TOTAL_PERCENTAGE = 100;\n      const COUNT_MONTHS = 12;\n      const percentage = Array.from(\n        { length: COUNT_MONTHS },\n        () => TOTAL_PERCENTAGE\n      );\n      const percentageBalance = Array.from(\n        { length: COUNT_MONTHS },\n        () => TOTAL_PERCENTAGE\n      );\n      actividadesAveriasMonth.forEach((averias, i) => {\n        if (averias >= 4) {\n          const INIT_VALUE_PROBLEM_PERCENTAGE = 18;\n          const countMentenimientoPreventivo =\n            actividadesMantenimientoPreventivoMonth[i];\n          const countMentenimientoCorrectivo =\n            actividadesMantenimientoCorrectivoMonth[i];\n          const averiasProblem = averias - CANT_CORRECT_AVERIAS;\n          let solutionAverias = 0;\n          let totalProblemPercentage = 0;\n          let totalBalancePercentage = 0;\n\n          solutionAverias =\n            averiasProblem -\n            countMentenimientoCorrectivo -\n            countMentenimientoPreventivo / 2;\n\n          if (solutionAverias > 0) {\n            for (let i = 1; i <= solutionAverias; i++) {\n              totalBalancePercentage += INIT_VALUE_PROBLEM_PERCENTAGE / i;\n            }\n          }\n          for (let i = 1; i <= averiasProblem; i++) {\n            totalProblemPercentage += INIT_VALUE_PROBLEM_PERCENTAGE / i;\n          }\n          const newPercentage = TOTAL_PERCENTAGE - totalProblemPercentage;\n          percentage[i] = newPercentage;\n          percentageBalance[i] = TOTAL_PERCENTAGE - totalBalancePercentage;\n        }\n      });\n      let balancePercentage = 0;\n      let balancePositivePercentage = 0;\n\n      percentage.forEach((monthPercentage) => {\n        balancePercentage += monthPercentage;\n      });\n      percentageBalance.forEach((monthPercentage) => {\n        balancePositivePercentage += monthPercentage;\n      });\n      setPercentageBalancePositive(balancePositivePercentage / COUNT_MONTHS);\n      setPercentagePositiveAverias(balancePercentage / COUNT_MONTHS);\n      createChartCountBreackdown(refChartCountBreackdown.current, {\n        preventivo: actividadesMantenimientoPreventivoMonth,\n        correctivo: actividadesMantenimientoCorrectivoMonth,\n        averias: actividadesAveriasMonth,\n      });\n      createChartEquip(refChartEquip.current, actividadesAveriasMonth);\n    }\n  }, [responseActividad]);\n\n  return (\n    <section\n      ref={refFicha}\n      className=\"relative w-full px-6 pt-4 pb-12 my-6 bg-gray-100 hola rounded-3xl font-objetive-regular\"\n    >\n      <div className=\"flex items-center justify-end\">\n        {userSelector.user.role === \"Admin\" ? (\n          <Link\n            to={{\n              pathname: \"/equipment/edit\",\n              state: { id: id },\n            }}\n            className=\"mt-4 mr-6 text-base underline table-autofont-objetive-bold\"\n          >\n            Editar equipo\n          </Link>\n        ) : null}\n        {hidex ? null : (\n          <button>\n            <XIcon\n              className=\"w-6 h-6 mt-4 text-gray-400\"\n              onClick={() => {\n                closeHandler(\"\", \"\");\n              }}\n            />\n          </button>\n        )}\n      </div>\n      <div className=\"px-10\">\n        <h2 className=\"text-3xl font-objetive-bold text-app-green-3\">\n          {data.name}\n        </h2>\n      </div>\n      <section className=\"grid grid-cols-2 px-10 gap-x-16\">\n        <div>\n          <div className=\"flex items-center my-3\">\n            <LocationMarkerIcon className=\"w-4 h-4 mr-2\" />\n            <p>\n              {data.linea ? data.linea.name : \"\"} -{\" \"}\n              {data.linea ? data.linea.lugar : \"\"} -{\" \"}\n              {data.estacion ? data.estacion.name : \"\"}\n            </p>\n          </div>\n          <h4\n            className={`mb-2 font-objetive-bold ${\n              data.funciona ? \"text-green-700\" : \"text-app-red-2\"\n            }`}\n          >\n            {data.estado}\n            <span className=\"text-sm text-black font-objetive-regular\">\n              {data.funciona ? \"\" : ` ·  dias inactivo`}\n            </span>\n          </h4>\n          <div className=\"grid grid-cols-3 mb-3 gap-x-6\">\n            <div className=\"col-span-2\">\n              <img\n                className=\"object-cover w-full h-full rounded-xl\"\n                src={img1}\n                alt=\"Imagen1\"\n                onError={onErrorImg1}\n                crossOrigin=\"anonymous\"\n              />\n            </div>\n            <div className=\"grid grid-cols-1 gap-y-6\">\n              <div>\n                <img\n                  className=\"object-cover w-full h-full rounded-xl \"\n                  src={img2}\n                  alt=\"Imagen2\"\n                  onError={onErrorImg2}\n                  crossOrigin=\"anonymous\"\n                />\n              </div>\n              <div>\n                <img\n                  className=\"object-cover w-full h-full rounded-xl\"\n                  src={img3}\n                  alt=\"Imagen3\"\n                  onError={onErrorImg3}\n                  crossOrigin=\"anonymous\"\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"mb-6 text-sm\">\n            <p>N de identificación: {data.identificacion}</p>\n            <p>Modelo {data.modelo}</p>\n            <p className=\"my-3\">{data.detalles}</p>\n            <p className=\"text-app-green-4\">\n              A cargo de {data.empresa ? data.empresa.name : \"\"}\n            </p>\n          </div>\n          <div className=\"text-sm\">\n            <h4 className=\"mb-2 font-objetive-bold\">\n              Mantenimientos del último mes\n            </h4>\n            {responseActividad.length > 0 ? (\n              responseActividad.slice(0, 3).map((actividad) => {\n                return (\n                  <div\n                    key={actividad.id}\n                    className=\"pt-2 mt-2 space-y-1 border-t border-gray-400\"\n                  >\n                    <h5 className=\"font-objetive-medium\">{actividad.tipo}</h5>\n                    <p className=\"text-xs\">Fecha de registro - 17/07/2021</p>\n                    <p className=\"text-xs\">\n                      {actividad.dias} {actividad.dias === 1 ? \"día\" : \"días\"}{\" \"}\n                      parado en reparación\n                    </p>\n                  </div>\n                );\n              })\n            ) : (\n              <div className=\"pt-2 mt-2 space-y-1 border-t border-gray-400\">\n                <h5 className=\"font-objetive-medium\">No registra actividad</h5>\n              </div>\n            )}\n          </div>\n        </div>\n        <div>\n          <div>\n            <h4 className=\"mb-4 text-sm\">Cantidad de averías</h4>\n            <div className=\"w-full p-6 bg-white shadow-md rounded-3xl\">\n              <div className=\"grid grid-cols-3 \">\n                <div className=\"col-span-2\">\n                  <canvas\n                    ref={refChartCountBreackdown}\n                    id=\"chartCantBreackdown\"\n                    height=\"250\"\n                    width=\"250\"\n                  ></canvas>\n                </div>\n                <div className=\"flex flex-col items-center justify-center\">\n                  <p className=\"text-3xl font-objetive-bold text-app-green-3\">\n                    {percentageBalancePositive} %\n                  </p>\n                  <p className=\"text-sm font-objetive-regular\">\n                    Balance positivo\n                  </p>\n                </div>\n              </div>\n              <div className=\"px-8 mt-8\" id=\"legend-container\">\n                <ul className=\"flex flex-col space-y-2 text-xs font-objetive-medium ul-chart\" />\n              </div>\n            </div>\n          </div>\n          <div className=\"mt-10 mb-8\">\n            <h4 className=\"mb-4 text-sm\">Rendimiento general del equipo</h4>\n            <div className=\"grid w-full grid-cols-3 p-6 bg-white shadow-md rounded-3xl\">\n              <div className=\"col-span-2\">\n                <p className=\"mb-6 ml-4 text-xs text-black font-objetive-medium\">\n                  Averías totales\n                </p>\n                <canvas\n                  className=\"ml-10\"\n                  ref={refChartEquip}\n                  id=\"chartEquip\"\n                ></canvas>\n              </div>\n              <div className=\"flex flex-col items-center justify-center text-black\">\n                <div className=\"flex flex-col items-center justify-center w-32 h-32 border rounded-full border-app-red-1\">\n                  <p className=\"text-3xl font-objetive-bold\">\n                    {percentagePositiveAverias} %\n                  </p>\n                  <p className=\"text-sm font-objetive-regular\">Positivo</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex justify-end\">\n            <button\n              onClick={handleClickDownloadFicha}\n              className=\"relative py-1 mr-6 text-xs rounded-full font-objetive-medium px-7 bg-app-green-1 text-app-green-3\"\n            >\n              <div className=\"absolute top-0 bottom-0 left-0 flex items-center\">\n                <DownloadIcon className=\"w-6 h-6 p-1 text-white rounded-full bg-app-green-3\" />\n              </div>\n              Descargar ficha\n            </button>\n            <button\n              onClick={handleClickDownloadHistorico}\n              className=\"relative py-1 text-xs rounded-full font-objetive-medium px-7 bg-app-green-1 text-app-green-3\"\n            >\n              <div className=\"absolute top-0 bottom-0 flex items-center -left-1\">\n                <DocumentDownloadIcon className=\"w-6 h-6 p-1 text-white rounded-full bg-app-green-3\" />\n              </div>\n              Descargar datos históricos\n            </button>\n          </div>\n        </div>\n      </section>\n    </section>\n  );\n};\n\nexport default Description;\n"]},"metadata":{},"sourceType":"module"}